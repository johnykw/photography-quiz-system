<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ”å½±æŠ€èƒ½è©•ä¼°å•å· - æ‰¾åˆ°æœ€é©åˆæ‚¨çš„æ”å½±èª²ç¨‹</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #333;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            max-width: 800px;
            width: 90%;
            text-align: center;
        }

        .camera-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 30px;
            font-size: 40px;
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 2.2em;
            font-weight: 600;
        }

        .subtitle {
            color: #666;
            margin-bottom: 40px;
            font-size: 1.1em;
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .feature {
            text-align: center;
        }

        .feature-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
        }

        .feature h3 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .feature p {
            color: #666;
            font-size: 0.95em;
        }

        .buttons {
            display: flex;
            justify-content: center;
            margin-top: 30px;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 12px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #e91e63 0%, #c2185b 100%);
            color: white;
        }

        .btn-tertiary {
            background: linear-gradient(135deg, #00bcd4 0%, #0097a7 100%);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        /* å•å·æ¨£å¼ */
        .quiz-container {
            display: none;
            text-align: left;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
            transition: width 0.3s ease;
        }

        .question-card {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .question-title {
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 20px;
            color: #333;
        }

        .options {
            display: grid;
            gap: 12px;
        }

        .option {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .option:hover {
            border-color: #667eea;
            background: #f0f4ff;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .option.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: translateY(-1px);
            box-shadow: 0 6px 16px rgba(102, 126, 234, 0.3);
        }

        .option-number {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #667eea;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-weight: 700;
            font-size: 0.95em;
            transition: all 0.3s ease;
        }

        .option.selected .option-number {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .option span {
            font-weight: 500;
            font-size: 1.05em;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        .nav-btn {
            padding: 18px 36px;
            border: none;
            border-radius: 12px;
            font-size: 1.2em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 140px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .nav-btn.prev {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
            color: white;
        }

        .nav-btn.prev:hover:not(:disabled) {
            background: linear-gradient(135deg, #495057 0%, #343a40 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }

        .nav-btn.next {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .nav-btn.next:hover:not(:disabled) {
            background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0,0,0,0.2);
        }

        /* çµæœé é¢æ¨£å¼ */
        .result-container {
            display: none;
            text-align: center;
        }

        .score-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 30px;
            font-size: 2.5em;
            font-weight: bold;
            color: white;
        }

        .level-badge {
            display: inline-block;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: 600;
            margin-bottom: 30px;
            color: white;
        }

        .courses {
            text-align: left;
            margin-top: 30px;
        }

        .course-summary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            text-align: center;
        }

        .course-summary p {
            margin: 8px 0;
            font-size: 1.1em;
        }

        .course-card {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
            display: flex;
            align-items: flex-start;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .course-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .course-number {
            font-size: 1.2em;
            font-weight: bold;
            color: #667eea;
            margin-right: 15px;
            min-width: 25px;
        }

        .course-content {
            flex: 1;
        }

        .course-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            font-size: 1.1em;
        }

        .course-meta {
            margin-bottom: 10px;
        }

        .course-category, .course-level {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 500;
            margin-right: 8px;
        }

        .course-category {
            background: #e3f2fd;
            color: #1976d2;
        }

        .course-level {
            background: #f3e5f5;
            color: #7b1fa2;
        }

        .course-description {
            color: #666;
            font-size: 0.95em;
            line-height: 1.5;
        }

        /* ç®¡ç†å“¡ç™»éŒ„æ¨£å¼ */
        .admin-login {
            display: none;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            max-width: 500px;
            width: 90%;
            text-align: center;
            margin: 0 auto;
        }
        
        .admin-login h2 {
            color: #333;
            margin-bottom: 30px;
            font-size: 1.8em;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        /* ç®¡ç†å“¡ä»‹é¢æ¨£å¼ */
        .admin-panel {
            display: none;
            text-align: left;
        }

        .admin-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .admin-title {
            font-size: 1.5em;
            font-weight: 600;
        }

        .admin-welcome {
            font-size: 1em;
        }

        .logout-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
        }

        .admin-menu {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .menu-item {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .menu-item:hover {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .menu-item.active {
            border-color: #667eea;
            background: #667eea;
            color: white;
        }

        .admin-content {
            background: white;
            border-radius: 12px;
            padding: 30px;
            border: 2px solid #e0e0e0;
        }

        .stats-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 1em;
            opacity: 0.9;
        }

        /* è©³ç´°çµ±è¨ˆæ¨£å¼ */
        .filter-section, .data-management-section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            align-items: end;
        }

        .data-management-section {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
        }

        .filter-section label, .data-management-section label {
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
            display: block;
        }

        .filter-section input, .data-management-section input {
            width: 100%;
            padding: 8px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 0.9em;
        }

        .filter-btn {
            background: #4CAF50 !important;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
        }

        .clear-filter-btn {
            background: #2196F3 !important;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
        }

        .clear-data-btn {
            background: #F44336 !important;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
        }

        .clear-all-btn {
            background: #FF9800 !important;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
        }

        .question-stat {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .question-stat h4 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .correct-rate {
            margin-bottom: 15px;
        }

        .correct-rate-label {
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .correct-rate-info {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .option-stats h5 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1em;
        }

        .option-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .option-item:last-child {
            border-bottom: none;
        }

        .option-text {
            flex: 1;
            color: #333;
        }

        .option-percentage {
            color: #666;
            font-weight: 600;
            margin-left: 10px;
        }

        .bar-chart {
            width: 100px;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            margin-left: 10px;
            overflow: hidden;
        }

        .bar-fill {
            height: 100%;
            background: #667eea;
            transition: width 0.3s ease;
        }

        .score-distribution {
            margin-top: 30px;
        }

        .score-distribution h3 {
            color: #333;
            margin-bottom: 20px;
        }

        .score-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .score-item:last-child {
            border-bottom: none;
        }

        .score-label {
            font-weight: 600;
            color: #333;
        }

        .score-bar {
            width: 200px;
            height: 12px;
            background: #e0e0e0;
            border-radius: 6px;
            margin: 0 15px;
            overflow: hidden;
        }

        .score-bar-fill {
            height: 100%;
            background: #4CAF50;
            transition: width 0.3s ease;
        }

        .score-percentage {
            color: #666;
            font-weight: 600;
            min-width: 50px;
            text-align: right;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
                margin: 20px;
            }

            .features {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .buttons {
                grid-template-columns: 1fr;
            }

            .admin-menu {
                grid-template-columns: 1fr;
            }

            .filter-section, .data-management-section {
                grid-template-columns: 1fr;
            }

            .score-bar {
                width: 100px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- é¦–é  -->
        <div id="home" class="home-page">
            <div class="camera-icon">ğŸ“·</div>
            <h1>æ”å½±æŠ€èƒ½è©•ä¼°å•å·</h1>
            <p class="subtitle">æ‰¾åˆ°æœ€é©åˆæ‚¨çš„æ”å½±èª²ç¨‹</p>
            
            <div class="features">
                <div class="feature">
                    <div class="feature-icon">â°</div>
                    <h3>é è¨ˆæ™‚é–“</h3>
                    <p>5-8åˆ†é˜</p>
                </div>
                <div class="feature">
                    <div class="feature-icon">ğŸ“š</div>
                    <h3>å°ˆæ¥­è©•ä¼°</h3>
                    <p>19é“ç²¾é¸å•é¡Œ</p>
                </div>
                <div class="feature">
                    <div class="feature-icon">ğŸ’</div>
                    <h3>å€‹äººåŒ–æ¨è–¦</h3>
                    <p>é‡èº«å®šåˆ¶èª²ç¨‹</p>
                </div>
            </div>
            
            <div class="buttons">
                <button class="btn btn-primary" onclick="startQuiz()">é–‹å§‹è©•ä¼° âœ¨</button>
            </div>
        </div>

        <!-- å•å·é é¢ -->
        <div id="quiz" class="quiz-container">
            <div class="progress-bar">
                <div class="progress-fill" id="progress"></div>
            </div>
            <div id="question-info" class="question-info"></div>
            <div id="question-container"></div>
            <div class="navigation">
                <button class="nav-btn prev" id="prev-btn" onclick="previousQuestion()" disabled>â† ä¸Šä¸€é¡Œ</button>
                <button class="nav-btn next" id="next-btn" onclick="nextQuestion()">ä¸‹ä¸€é¡Œ â†’</button>
            </div>
        </div>

        <!-- çµæœé é¢ -->
        <div id="result" class="result-container">
            <h2>æ‚¨çš„æ”å½±æŠ€èƒ½è©•ä¼°çµæœ</h2>
            <div id="score-display"></div>
            <div id="level-display"></div>
            <div id="courses-display"></div>
            <button class="btn btn-primary" onclick="restartQuiz()" style="margin-top: 30px;">é‡æ–°é–‹å§‹</button>
        </div>

        <!-- ç®¡ç†å“¡ç™»éŒ„ -->
        <div id="admin-login" class="admin-login">
            <h2>ç®¡ç†å“¡ç™»éŒ„</h2>
            <div class="form-group">
                <label>ç”¨æˆ¶å</label>
                <input type="text" id="admin-username" placeholder="è«‹è¼¸å…¥ç”¨æˆ¶å">
            </div>
            <div class="form-group">
                <label>å¯†ç¢¼</label>
                <input type="password" id="admin-password" placeholder="è«‹è¼¸å…¥å¯†ç¢¼">
            </div>
            <div class="buttons">
                <button class="btn btn-primary" onclick="adminLogin()">ç™»éŒ„</button>
                <button class="btn btn-secondary" onclick="showHome()">è¿”å›é¦–é </button>
            </div>
        </div>

        <!-- ç®¡ç†å“¡é¢æ¿ -->
        <div id="admin-panel" class="admin-panel">
            <div class="admin-header">
                <div>
                    <div class="admin-title">æ”å½±å•å·ç®¡ç†ç³»çµ±</div>
                    <div class="admin-welcome">æ­¡è¿ï¼Œç®¡ç†å“¡</div>
                </div>
                <button class="logout-btn" onclick="adminLogout()">ç™»å‡º</button>
            </div>

            <div class="admin-menu">
                <div class="menu-item active" onclick="showAdminSection('dashboard')">å„€è¡¨æ¿</div>
                <div class="menu-item" onclick="showAdminSection('questions')">å•é¡Œç®¡ç†</div>
                <div class="menu-item" onclick="showAdminSection('courses')">èª²ç¨‹ç®¡ç†</div>
                <div class="menu-item" onclick="showAdminSection('score-settings')">è©•åˆ†è¨­å®š</div>
                <div class="menu-item" onclick="showAdminSection('responses')">å³æ™‚æŸ¥çœ‹å›æ‡‰</div>
                <div class="menu-item" onclick="showAdminSection('users')">ç”¨æˆ¶è³‡æ–™</div>
                <div class="menu-item" onclick="showAdminSection('detailed-stats')">è©³ç´°çµ±è¨ˆ</div>
                <div class="menu-item" onclick="showAdminSection('export')">æ•¸æ“šå°å‡º</div>
            </div>

            <!-- å„€è¡¨æ¿ -->
            <div id="dashboard" class="admin-content">
                <h3>ç³»çµ±çµ±è¨ˆæ¦‚è¦½</h3>
                <div class="stats-overview" id="stats-overview">
                    <!-- çµ±è¨ˆæ•¸æ“šå°‡åœ¨é€™è£¡å‹•æ…‹è¼‰å…¥ -->
                </div>
            </div>

            <!-- è©³ç´°çµ±è¨ˆ -->
            <div id="detailed-stats" class="admin-content" style="display: none;">
                <h3>è©³ç´°çµ±è¨ˆ</h3>
                
                <!-- æ•¸æ“šç¯©é¸å€å¡Š -->
                <div class="filter-section">
                    <div>
                        <label>é–‹å§‹æ—¥æœŸï¼š</label>
                        <input type="date" id="start-date">
                    </div>
                    <div>
                        <label>çµæŸæ—¥æœŸï¼š</label>
                        <input type="date" id="end-date">
                    </div>
                    <div>
                        <button onclick="filterData()" class="filter-btn">ç¯©é¸</button>
                    </div>
                    <div>
                        <button onclick="clearFilter()" class="clear-filter-btn">æ¸…é™¤ç¯©é¸</button>
                    </div>
                </div>
                
                <!-- æ•¸æ“šç®¡ç†å€å¡Š -->
                <div class="data-management-section">
                    <h4 style="grid-column: 1 / -1; margin: 0 0 15px 0;">æ•¸æ“šç®¡ç†</h4>
                    <div>
                        <label>æ¸…é™¤é–‹å§‹æ—¥æœŸï¼š</label>
                        <input type="date" id="clear-start-date">
                    </div>
                    <div>
                        <label>æ¸…é™¤çµæŸæ—¥æœŸï¼š</label>
                        <input type="date" id="clear-end-date">
                    </div>
                    <div>
                        <button onclick="clearDataByDate()" class="clear-data-btn">æ¸…é™¤æ•¸æ“š</button>
                    </div>
                    <div>
                        <button onclick="clearAllData()" class="clear-all-btn">æ¸…é™¤æ‰€æœ‰æ•¸æ“š</button>
                    </div>
                </div>
                
                <div id="stats-content">
                    <div id="total-responses"></div>
                    <div id="question-stats"></div>
                    <div id="score-distribution"></div>
                </div>
            </div>

            <!-- å…¶ä»–ç®¡ç†åŠŸèƒ½ -->
            <div id="questions" class="admin-content" style="display: none;">
                <h3>å•é¡Œç®¡ç†</h3>
                
                <div style="margin-bottom: 20px;">
                    <button class="btn btn-primary" onclick="showAddQuestionModal()">æ·»åŠ æ–°å•é¡Œ</button>
                </div>
                
                <div id="questions-list">
                    <!-- å•é¡Œåˆ—è¡¨å°‡åœ¨é€™è£¡å‹•æ…‹è¼‰å…¥ -->
                </div>
                
                <!-- æ·»åŠ /ç·¨è¼¯å•é¡Œæ¨¡æ…‹æ¡† -->
                <div id="question-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000;">
                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 15px; width: 90%; max-width: 600px; max-height: 80vh; overflow-y: auto;">
                        <h4 id="question-modal-title">æ·»åŠ æ–°å•é¡Œ</h4>
                        
                        <div style="margin-bottom: 15px;">
                            <label>å•é¡Œå…§å®¹ï¼š</label>
                            <textarea id="question-content" style="width: 100%; height: 80px; padding: 10px; border: 1px solid #ddd; border-radius: 5px; resize: vertical;"></textarea>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <label>å•é¡Œé¡å‹ï¼š</label>
                            <select id="question-type" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                <option value="single">å–®é¸é¡Œ</option>
                                <option value="multiple">å¤šé¸é¡Œ</option>
                            </select>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <label>é¸é …ï¼š</label>
                            <div id="question-options">
                                <!-- é¸é …å°‡åœ¨é€™è£¡å‹•æ…‹æ·»åŠ  -->
                            </div>
                            <button type="button" onclick="addQuestionOption()" style="margin-top: 10px; padding: 5px 15px; background: #667eea; color: white; border: none; border-radius: 5px;">æ·»åŠ é¸é …</button>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label>æ­£ç¢ºç­”æ¡ˆï¼š</label>
                            <div id="correct-answer-section">
                                <!-- æ­£ç¢ºç­”æ¡ˆé¸æ“‡å°‡åœ¨é€™è£¡é¡¯ç¤º -->
                            </div>
                        </div>
                        
                        <div style="text-align: right;">
                            <button type="button" onclick="closeQuestionModal()" style="margin-right: 10px; padding: 10px 20px; background: #ccc; color: #333; border: none; border-radius: 5px;">å–æ¶ˆ</button>
                            <button type="button" onclick="saveQuestion()" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 5px;">ä¿å­˜</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="courses" class="admin-content" style="display: none;">
                <h3>èª²ç¨‹ç®¡ç†</h3>
                
                <!-- èª²ç¨‹ç®¡ç†ä¸»è¦é¸é … -->
                <div style="display: flex; gap: 15px; margin-bottom: 25px; align-items: center; flex-wrap: wrap;">
                    <button class="btn btn-primary" onclick="showAddCourseModal()" style="background: #28a745; border-color: #28a745;">
                        â• å¢åŠ èª²ç¨‹
                    </button>
                    <button class="btn btn-primary" onclick="showEditCourseSelection()" style="background: #007bff; border-color: #007bff;">
                        âœï¸ ç·¨è¼¯èª²ç¨‹
                    </button>
                    <button class="btn btn-primary" onclick="showDeleteCourseSelection()" style="background: #dc3545; border-color: #dc3545;">
                        ğŸ—‘ï¸ åˆªé™¤èª²ç¨‹
                    </button>
                    <button class="btn btn-primary" onclick="showRecommendationSettings()" style="background: #6f42c1; border-color: #6f42c1;">
                        ğŸ“Š æ¨ä»‹èª²ç¨‹æ•¸é‡
                    </button>
                </div>
                
                <!-- èª²ç¨‹ç®¡ç†å…§å®¹å€åŸŸ -->
                <div id="course-management-content">
                    <!-- é è¨­é¡¯ç¤ºèª²ç¨‹åˆ—è¡¨ -->
                    <div id="courses-list-view">
                        <h4 style="margin-bottom: 15px; color: #333;">ğŸ“š èª²ç¨‹ç¸½è¦½</h4>
                        <div id="courses-list">
                            <!-- èª²ç¨‹åˆ—è¡¨å°‡åœ¨é€™è£¡å‹•æ…‹è¼‰å…¥ -->
                        </div>
                    </div>
                    
                    <!-- ç·¨è¼¯èª²ç¨‹é¸æ“‡ç•Œé¢ -->
                    <div id="edit-course-selection" style="display: none;">
                        <h4 style="margin-bottom: 15px; color: #333;">âœï¸ é¸æ“‡è¦ç·¨è¼¯çš„èª²ç¨‹</h4>
                        <div id="edit-courses-list">
                            <!-- å¯ç·¨è¼¯èª²ç¨‹åˆ—è¡¨å°‡åœ¨é€™è£¡å‹•æ…‹è¼‰å…¥ -->
                        </div>
                        <button onclick="showCoursesListView()" style="margin-top: 15px; padding: 8px 16px; background: #6c757d; color: white; border: none; border-radius: 5px;">
                            â† è¿”å›èª²ç¨‹ç¸½è¦½
                        </button>
                    </div>
                    
                    <!-- åˆªé™¤èª²ç¨‹é¸æ“‡ç•Œé¢ -->
                    <div id="delete-course-selection" style="display: none;">
                        <h4 style="margin-bottom: 15px; color: #333;">ğŸ—‘ï¸ é¸æ“‡è¦åˆªé™¤çš„èª²ç¨‹</h4>
                        <div style="background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 8px; padding: 15px; margin-bottom: 20px;">
                            <p style="margin: 0; color: #856404; font-size: 14px;">
                                âš ï¸ <strong>æ³¨æ„ï¼š</strong>åˆªé™¤èª²ç¨‹å¾Œå°‡ç„¡æ³•æ¢å¾©ï¼Œè«‹è¬¹æ…æ“ä½œã€‚
                            </p>
                        </div>
                        <div id="delete-courses-list">
                            <!-- å¯åˆªé™¤èª²ç¨‹åˆ—è¡¨å°‡åœ¨é€™è£¡å‹•æ…‹è¼‰å…¥ -->
                        </div>
                        <button onclick="showCoursesListView()" style="margin-top: 15px; padding: 8px 16px; background: #6c757d; color: white; border: none; border-radius: 5px;">
                            â† è¿”å›èª²ç¨‹ç¸½è¦½
                        </button>
                    </div>
                    
                    <!-- æ¨ä»‹èª²ç¨‹æ•¸é‡è¨­å®š -->
                    <div id="recommendation-settings" style="display: none;">
                        <h4 style="margin-bottom: 15px; color: #333;">ğŸ“Š æ¨ä»‹èª²ç¨‹æ•¸é‡è¨­å®š</h4>
                        <div style="background: #e7f3ff; border: 1px solid #b3d9ff; border-radius: 8px; padding: 15px; margin-bottom: 20px;">
                            <p style="margin: 0; color: #0056b3; font-size: 14px;">
                                ğŸ’¡ <strong>èªªæ˜ï¼š</strong>è¨­å®šåƒèˆ‡è€…å®Œæˆå•å·å¾Œç³»çµ±æ¨è–¦çš„èª²ç¨‹æ•¸é‡ç¯„åœï¼ˆ0-100å€‹èª²ç¨‹ï¼‰ã€‚
                            </p>
                        </div>
                        
                        <!-- ç•¶å‰å•Ÿç”¨è¨­å®š -->
                        <div id="current-recommendation-setting" style="background: #d4edda; border: 1px solid #c3e6cb; border-radius: 8px; padding: 15px; margin-bottom: 20px;">
                            <!-- ç•¶å‰è¨­å®šå°‡åœ¨é€™è£¡é¡¯ç¤º -->
                        </div>
                        
                        <!-- æ‰€æœ‰è¨­å®šåˆ—è¡¨ -->
                        <div id="recommendation-settings-list">
                            <!-- è¨­å®šåˆ—è¡¨å°‡åœ¨é€™è£¡å‹•æ…‹è¼‰å…¥ -->
                        </div>
                        
                        <!-- æ“ä½œæŒ‰éˆ• -->
                        <div style="margin-top: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
                            <button onclick="showAddRecommendationSettingModal()" style="padding: 8px 16px; background: #28a745; color: white; border: none; border-radius: 5px;">
                                â• æ–°å¢è¨­å®š
                            </button>
                            <button onclick="showCoursesListView()" style="padding: 8px 16px; background: #6c757d; color: white; border: none; border-radius: 5px;">
                                â† è¿”å›èª²ç¨‹ç¸½è¦½
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- æ·»åŠ /ç·¨è¼¯èª²ç¨‹æ¨¡æ…‹æ¡† -->
                <div id="course-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000;">
                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 15px; width: 90%; max-width: 600px; max-height: 80vh; overflow-y: auto;">
                        <h4 id="course-modal-title">æ·»åŠ æ–°èª²ç¨‹</h4>
                        
                        <div style="margin-bottom: 15px;">
                            <label>èª²ç¨‹æ¨™é¡Œï¼š</label>
                            <input type="text" id="course-title" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <label>èª²ç¨‹æè¿°ï¼š</label>
                            <textarea id="course-description" style="width: 100%; height: 100px; padding: 10px; border: 1px solid #ddd; border-radius: 5px; resize: vertical;"></textarea>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <label>èª²ç¨‹åˆ†é¡ï¼š</label>
                            <select id="course-category" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                <option value="æ–°æ‰‹å…¥é–€">æ–°æ‰‹å…¥é–€</option>
                                <option value="åˆéšæ”å½±">åˆéšæ”å½±</option>
                                <option value="é€²éšæ”å½±">é€²éšæ”å½±</option>
                                <option value="å°ˆæ¥­æŠ€è¡“">å°ˆæ¥­æŠ€è¡“</option>
                            </select>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <label>é©åˆç¨‹åº¦ï¼š</label>
                            <select id="course-level" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                                <option value="æ”å½±æ–°æ‰‹">æ”å½±æ–°æ‰‹</option>
                                <option value="ä¸­éšæ”å½±å¸«">ä¸­éšæ”å½±å¸«</option>
                                <option value="é€²éšæ”å½±å¸«">é€²éšæ”å½±å¸«</option>
                                <option value="æ‰€æœ‰ç¨‹åº¦">æ‰€æœ‰ç¨‹åº¦</option>
                            </select>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <label style="display: flex; align-items: center; gap: 10px;">
                                <input type="checkbox" id="course-active" checked style="transform: scale(1.2);">
                                <span>èª²ç¨‹é–‹å•Ÿï¼ˆå–æ¶ˆå‹¾é¸å‰‡é—œé–‰èª²ç¨‹ï¼Œä¸æœƒåœ¨æ¨è–¦ä¸­é¡¯ç¤ºï¼‰</span>
                            </label>
                        </div>
                        
                        <div style="margin-bottom: 20px;">
                            <label>èˆˆè¶£é—œè¯ï¼ˆé¸æ“‡æ­¤èª²ç¨‹é©åˆçš„æ”å½±é¡Œæï¼‰ï¼š</label>
                            <div id="interest-tags-container" style="margin-top: 10px; max-height: 200px; overflow-y: auto; border: 1px solid #ddd; border-radius: 5px; padding: 15px; background: #f9f9f9;">
                                <!-- èˆˆè¶£æ¨™ç±¤é¸é …å°‡åœ¨é€™è£¡å‹•æ…‹è¼‰å…¥ -->
                            </div>
                        </div>
                        
                        <div style="text-align: right;">
                            <button type="button" onclick="closeCourseModal()" style="margin-right: 10px; padding: 10px 20px; background: #ccc; color: #333; border: none; border-radius: 5px;">å–æ¶ˆ</button>
                            <button type="button" onclick="saveCourse()" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 5px;">ä¿å­˜</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- è©•åˆ†è¨­å®š -->
            <div id="score-settings" class="admin-content" style="display: none;">
                <h3>è©•åˆ†è¨­å®š</h3>
                
                <div style="background: white; padding: 25px; border-radius: 15px; margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h4>æ”å½±å¸«ç­‰ç´šåˆ†æ•¸è¨­å®š</h4>
                        <button onclick="refreshScoreSettings()" style="padding: 8px 16px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">
                            ğŸ”„ åˆ·æ–°è¨­å®š
                        </button>
                    </div>
                    
                    <div style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px;">
                        <p style="margin: 0; color: #666; font-size: 14px;">
                            <strong>èªªæ˜ï¼š</strong>æ‚¨å¯ä»¥è‡ªè¨‚å„ç­‰ç´šæ”å½±å¸«çš„åˆ†æ•¸ç¯„åœã€‚åˆ†æ•¸ç¯„åœä¸èƒ½é‡ç–Šï¼Œç³»çµ±æœƒæ ¹æ“šåƒèˆ‡è€…çš„åˆ†æ•¸è‡ªå‹•åˆ†é…ç­‰ç´šä¸¦æ¨è–¦ç›¸æ‡‰èª²ç¨‹ã€‚
                        </p>
                    </div>
                    
                    <div id="score-settings-list">
                        <!-- è©•åˆ†è¨­å®šåˆ—è¡¨å°‡åœ¨é€™è£¡å‹•æ…‹è¼‰å…¥ -->
                        <p style="text-align: center; color: #666; padding: 40px;">è¼‰å…¥ä¸­...</p>
                    </div>
                </div>
            </div>

            <!-- æ¨ä»‹èª²ç¨‹æ•¸é‡è¨­å®šæ¨¡æ…‹æ¡† -->
            <div id="recommendation-setting-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000;">
                <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 15px; width: 90%; max-width: 500px; max-height: 80vh; overflow-y: auto;">
                    <h4 id="recommendation-setting-modal-title">æ–°å¢æ¨ä»‹èª²ç¨‹æ•¸é‡è¨­å®š</h4>
                    
                    <div style="margin-bottom: 15px;">
                        <label>è¨­å®šåç¨±ï¼š</label>
                        <input type="text" id="recommendation-setting-name" placeholder="ä¾‹å¦‚ï¼šæ¨™æº–æ¨è–¦ã€ç²¾é¸æ¨è–¦" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <label>æœ€å°‘èª²ç¨‹æ•¸é‡ï¼ˆ0-100ï¼‰ï¼š</label>
                        <input type="number" id="recommendation-min-courses" min="0" max="100" value="3" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <label>æœ€å¤šèª²ç¨‹æ•¸é‡ï¼ˆ0-100ï¼‰ï¼š</label>
                        <input type="number" id="recommendation-max-courses" min="0" max="100" value="8" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <label>è¨­å®šæè¿°ï¼š</label>
                        <textarea id="recommendation-setting-description" placeholder="æè¿°é€™å€‹æ¨è–¦è¨­å®šçš„ç”¨é€”..." style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; height: 80px; resize: vertical;"></textarea>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" id="recommendation-setting-active" checked>
                            å•Ÿç”¨æ­¤è¨­å®š
                        </label>
                    </div>
                    
                    <div style="text-align: right; margin-top: 20px;">
                        <button type="button" onclick="closeRecommendationSettingModal()" style="padding: 10px 20px; background: #6c757d; color: white; border: none; border-radius: 5px; margin-right: 10px;">å–æ¶ˆ</button>
                        <button type="button" onclick="saveRecommendationSetting()" style="padding: 10px 20px; background: #6f42c1; color: white; border: none; border-radius: 5px;">ä¿å­˜</button>
                    </div>
                </div>
            </div>

            <!-- è©•åˆ†è¨­å®šæ¨¡æ…‹æ¡† -->
            <div id="score-setting-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000;">
                <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 15px; width: 90%; max-width: 500px; max-height: 80vh; overflow-y: auto;">
                    <h4 id="score-setting-modal-title">ç·¨è¼¯è©•åˆ†è¨­å®š</h4>
                    
                    <div style="margin-bottom: 15px;">
                        <label>ç­‰ç´šåç¨±ï¼š</label>
                        <input type="text" id="score-setting-level-name" placeholder="ä¾‹å¦‚ï¼šæ”å½±æ–°æ‰‹ã€é€²éšæ”å½±å¸«" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <label>æœ€ä½åˆ†æ•¸ï¼ˆ0-100ï¼‰ï¼š</label>
                        <input type="number" id="score-setting-min-score" min="0" max="100" value="0" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <label>æœ€é«˜åˆ†æ•¸ï¼ˆ0-100ï¼‰ï¼š</label>
                        <input type="number" id="score-setting-max-score" min="0" max="100" value="10" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <label>ç­‰ç´šæè¿°ï¼š</label>
                        <textarea id="score-setting-description" placeholder="æè¿°é€™å€‹ç­‰ç´šçš„ç‰¹é»å’Œé©åˆçš„èª²ç¨‹..." style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; height: 80px; resize: vertical;"></textarea>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <label style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" id="score-setting-active" checked>
                            å•Ÿç”¨æ­¤ç­‰ç´š
                        </label>
                    </div>
                    
                    <div style="text-align: right; margin-top: 20px;">
                        <button type="button" onclick="closeScoreSettingModal()" style="padding: 10px 20px; background: #6c757d; color: white; border: none; border-radius: 5px; margin-right: 10px;">å–æ¶ˆ</button>
                        <button type="button" onclick="saveScoreSetting()" style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 5px;">ä¿å­˜</button>
                    </div>
                </div>
            </div>

            <div id="responses" class="admin-content" style="display: none;">
                <h3>å³æ™‚æŸ¥çœ‹å›æ‡‰</h3>
                
                <div style="background: white; padding: 25px; border-radius: 15px; margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h4>å¯¦æ™‚çµ±è¨ˆ</h4>
                        <button onclick="refreshRealTimeStats()" style="padding: 8px 16px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">
                            ğŸ”„ åˆ·æ–°æ•¸æ“š
                        </button>
                    </div>
                    
                    <div id="real-time-stats-content">
                        <p style="text-align: center; color: #666; padding: 40px;">è¼‰å…¥ä¸­...</p>
                    </div>
                </div>
            </div>

            <div id="users" class="admin-content" style="display: none;">
                <h3>ç”¨æˆ¶è³‡æ–™</h3>
                
                <div style="background: white; padding: 25px; border-radius: 15px; margin-bottom: 20px;">
                    <h4 style="margin-bottom: 20px;">ç®¡ç†å“¡è³‡æ–™</h4>
                    
                    <div style="margin-bottom: 15px;">
                        <label>ç”¨æˆ¶åï¼š</label>
                        <input type="text" id="admin-profile-username" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <label>æ–°å¯†ç¢¼ï¼š</label>
                        <input type="password" id="admin-profile-password" placeholder="ç•™ç©ºå‰‡ä¸ä¿®æ”¹å¯†ç¢¼" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <label>ç¢ºèªæ–°å¯†ç¢¼ï¼š</label>
                        <input type="password" id="admin-profile-password-confirm" placeholder="ç•™ç©ºå‰‡ä¸ä¿®æ”¹å¯†ç¢¼" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    
                    <div style="text-align: right;">
                        <button type="button" onclick="updateAdminProfile()" style="padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 5px;">æ›´æ–°è³‡æ–™</button>
                    </div>
                </div>
                
                <div style="background: #f8f9fa; padding: 20px; border-radius: 15px;">
                    <h4 style="margin-bottom: 15px;">å¸³æˆ¶ä¿¡æ¯</h4>
                    <div id="admin-profile-info">
                        <!-- ç®¡ç†å“¡è³‡æ–™å°‡åœ¨é€™è£¡é¡¯ç¤º -->
                    </div>
                </div>
            </div>

            <div id="export" class="admin-content" style="display: none;">
                <h3>æ•¸æ“šå°å‡º</h3>
                
                <div style="background: white; padding: 25px; border-radius: 15px; margin-bottom: 20px;">
                    <h4 style="margin-bottom: 20px;">ç¯©é¸æ¢ä»¶</h4>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-weight: bold;">é–‹å§‹æ—¥æœŸï¼š</label>
                            <input type="datetime-local" id="export-start-date" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-weight: bold;">çµæŸæ—¥æœŸï¼š</label>
                            <input type="datetime-local" id="export-end-date" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 20px;">
                        <button onclick="clearExportDates()" style="padding: 8px 16px; background: #6c757d; color: white; border: none; border-radius: 5px; margin-right: 10px;">æ¸…é™¤æ—¥æœŸ</button>
                        <button onclick="setTodayRange()" style="padding: 8px 16px; background: #28a745; color: white; border: none; border-radius: 5px; margin-right: 10px;">ä»Šå¤©</button>
                        <button onclick="setWeekRange()" style="padding: 8px 16px; background: #17a2b8; color: white; border: none; border-radius: 5px; margin-right: 10px;">æœ¬é€±</button>
                        <button onclick="setMonthRange()" style="padding: 8px 16px; background: #ffc107; color: black; border: none; border-radius: 5px;">æœ¬æœˆ</button>
                    </div>
                </div>
                
                <div style="background: white; padding: 25px; border-radius: 15px; margin-bottom: 20px;">
                    <h4 style="margin-bottom: 20px;">æ•¸æ“šæ¸…é™¤</h4>
                    
                    <div style="margin-bottom: 15px;">
                        <button onclick="clearFilteredData()" style="padding: 10px 20px; background: #fd7e14; color: white; border: none; border-radius: 5px; margin-right: 10px;">æ¸…é™¤ç¯©é¸ç¯„åœå…§çš„è³‡æ–™</button>
                        <button onclick="clearAllData()" style="padding: 10px 20px; background: #dc3545; color: white; border: none; border-radius: 5px;">æ¸…é™¤æ‰€æœ‰è³‡æ–™</button>
                    </div>
                    
                    <p style="color: #6c757d; font-size: 14px; margin: 0;">
                        âš ï¸ æ³¨æ„ï¼šæ•¸æ“šæ¸…é™¤æ“ä½œç„¡æ³•æ’¤éŠ·ï¼Œè«‹è¬¹æ…æ“ä½œ
                    </p>
                </div>
                
                <div style="background: white; padding: 25px; border-radius: 15px;">
                    <h4 style="margin-bottom: 20px;">æ•¸æ“šå°å‡º</h4>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div style="text-align: center; padding: 20px; border: 2px dashed #28a745; border-radius: 10px;">
                            <div style="font-size: 48px; color: #28a745; margin-bottom: 10px;">ğŸ“Š</div>
                            <h5 style="margin-bottom: 10px;">Excel æ ¼å¼</h5>
                            <p style="color: #6c757d; margin-bottom: 15px;">å°å‡ºè©³ç´°çš„çµ±è¨ˆæ•¸æ“šè¡¨æ ¼</p>
                            <button onclick="exportExcel()" style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 5px; width: 100%;">
                                <span id="excel-loading" style="display: none;">å°å‡ºä¸­...</span>
                                <span id="excel-text">å°å‡º Excel</span>
                            </button>
                        </div>
                        
                        <div style="text-align: center; padding: 20px; border: 2px dashed #fd7e14; border-radius: 10px;">
                            <div style="font-size: 48px; color: #fd7e14; margin-bottom: 10px;">ğŸ“ˆ</div>
                            <h5 style="margin-bottom: 10px;">PowerPoint æ ¼å¼</h5>
                            <p style="color: #6c757d; margin-bottom: 15px;">å°å‡ºåœ–åƒåŒ–çµ±è¨ˆå ±å‘Š</p>
                            <button onclick="exportPowerPoint()" style="padding: 10px 20px; background: #fd7e14; color: white; border: none; border-radius: 5px; width: 100%;">
                                <span id="ppt-loading" style="display: none;">å°å‡ºä¸­...</span>
                                <span id="ppt-text">å°å‡º PowerPoint</span>
                            </button>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px; padding: 15px; background: #f8f9fa; border-radius: 5px;">
                        <h6 style="margin-bottom: 10px;">å°å‡ºèªªæ˜ï¼š</h6>
                        <ul style="margin: 0; padding-left: 20px; color: #6c757d;">
                            <li>Excelæ ¼å¼åŒ…å«è©³ç´°çš„å•é¡Œçµ±è¨ˆã€é¸é …åˆ†æå’Œå›æ‡‰æ•¸æ“š</li>
                            <li>PowerPointæ ¼å¼åŒ…å«åœ–è¡¨åŒ–çš„çµ±è¨ˆå ±å‘Šå’Œè¦–è¦ºåŒ–åˆ†æ</li>
                            <li>å¯ä»¥æ ¹æ“šæ—¥æœŸç¯„åœç¯©é¸è¦å°å‡ºçš„æ•¸æ“š</li>
                            <li>å°å‡ºçš„æ–‡ä»¶æœƒè‡ªå‹•ä¸‹è¼‰åˆ°æ‚¨çš„è¨­å‚™</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let questions = [];
        let currentQuestion = 0;
        let answers = [];
        let isTestMode = false;

        // é é¢é¡¯ç¤ºå‡½æ•¸
        function showPage(pageId) {
            console.log('showPageèª¿ç”¨ï¼Œç›®æ¨™é é¢:', pageId);
            
            // éš±è—æ‰€æœ‰é é¢
            const pages = ['home', 'quiz', 'result', 'admin-login', 'admin-panel'];
            pages.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.style.display = 'none';
                    console.log('éš±è—é é¢:', id);
                } else {
                    console.log('æ‰¾ä¸åˆ°é é¢å…ƒç´ :', id);
                }
            });
            
            // é¡¯ç¤ºç›®æ¨™é é¢
            const targetPage = document.getElementById(pageId);
            if (targetPage) {
                targetPage.style.display = 'block';
                console.log('é¡¯ç¤ºé é¢:', pageId);
            } else {
                console.error('æ‰¾ä¸åˆ°ç›®æ¨™é é¢:', pageId);
            }
        }

        function showHome() {
            showPage('home');
        }

        function showAdminLogin() {
            showPage('admin-login');
        }

        // è¼‰å…¥å•é¡Œ
        async function loadQuestions() {
            try {
                console.log('é–‹å§‹è¼‰å…¥å•é¡Œ...');
                const response = await fetch('/api/questions');
                console.log('APIéŸ¿æ‡‰ç‹€æ…‹:', response.status);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('è¼‰å…¥çš„å•é¡Œæ•¸æ“š:', data);
                console.log('å•é¡Œæ•¸é‡:', data.length);
                
                // ç¢ºä¿æ­£ç¢ºè³¦å€¼çµ¦å…¨å±€è®Šé‡
                questions = data;
                console.log('è³¦å€¼å¾Œçš„questionsé•·åº¦:', questions.length);
                console.log('å…¨å±€questionsè®Šé‡:', questions);
                
                return data;
            } catch (error) {
                console.error('è¼‰å…¥å•é¡Œå¤±æ•—:', error);
                alert('è¼‰å…¥å•é¡Œå¤±æ•—ï¼Œè«‹é‡æ–°æ•´ç†é é¢');
                throw error;
            }
        }

        // é–‹å§‹å•å·
        async function startQuiz() {
            console.log('é–‹å§‹å•å·...');
            isTestMode = false;
            
            try {
                await loadQuestions();
                console.log('è¼‰å…¥å®Œæˆï¼Œquestionsé•·åº¦:', questions.length);
                
                if (!questions || questions.length === 0) {
                    console.error('æ²’æœ‰å¯ç”¨çš„å•é¡Œ');
                    alert('æ²’æœ‰å¯ç”¨çš„å•é¡Œ');
                    return;
                }
                
                currentQuestion = 0;
                answers = [];
                console.log('åˆ‡æ›åˆ°å•å·é é¢...');
                showPage('quiz');
                console.log('é¡¯ç¤ºç¬¬ä¸€é¡Œ...');
                displayQuestion();
            } catch (error) {
                console.error('é–‹å§‹å•å·å¤±æ•—:', error);
                alert('é–‹å§‹å•å·å¤±æ•—ï¼Œè«‹é‡è©¦');
            }
        }

        // æ¸¬è©¦æ¨¡å¼
        async function startTestMode() {
            console.log('é–‹å§‹æ¸¬è©¦æ¨¡å¼...');
            isTestMode = true;
            
            try {
                await loadQuestions();
                console.log('æ¸¬è©¦æ¨¡å¼è¼‰å…¥å®Œæˆï¼Œquestionsé•·åº¦:', questions.length);
                
                if (!questions || questions.length === 0) {
                    console.error('æ²’æœ‰å¯ç”¨çš„å•é¡Œ');
                    alert('æ²’æœ‰å¯ç”¨çš„å•é¡Œ');
                    return;
                }
                
                // åˆå§‹åŒ–ç­”æ¡ˆæ•¸çµ„
                answers = new Array(questions.length).fill(null);
                
                // å¿«é€Ÿè‡ªå‹•ç­”é¡Œå‰17é¡Œ
                console.log('å¿«é€Ÿè‡ªå‹•ç­”é¡Œå‰17é¡Œ...');
                for (let i = 0; i < Math.min(17, questions.length); i++) {
                    const question = questions[i];
                    let answer;
                    
                    if (question.question_type === 'multiple') {
                        // å¤šé¸é¡Œéš¨æ©Ÿé¸æ“‡1-3å€‹é¸é …
                        const numSelections = Math.floor(Math.random() * 3) + 1;
                        answer = [];
                        for (let j = 0; j < numSelections; j++) {
                            const randomOption = Math.floor(Math.random() * question.options.length);
                            if (!answer.includes(randomOption)) {
                                answer.push(randomOption);
                            }
                        }
                    } else {
                        // å–®é¸é¡Œéš¨æ©Ÿé¸æ“‡ä¸€å€‹é¸é …
                        answer = Math.floor(Math.random() * question.options.length);
                    }
                    
                    answers[i] = answer;
                    console.log(`ç¬¬${i+1}é¡Œè‡ªå‹•ç­”é¡Œå®Œæˆ:`, answer);
                }
                
                // è·³åˆ°ç¬¬18é¡Œè®“ç”¨æˆ¶æ‰‹å‹•é¸æ“‡
                currentQuestion = Math.min(17, questions.length - 1); // ç¬¬18é¡Œçš„ç´¢å¼•æ˜¯17
                console.log('åˆ‡æ›åˆ°å•å·é é¢...');
                showPage('quiz');
                console.log(`è·³åˆ°ç¬¬${currentQuestion + 1}é¡Œï¼Œè®“ç”¨æˆ¶æ‰‹å‹•é¸æ“‡...`);
                displayQuestion();
                
                // é¡¯ç¤ºæ¸¬è©¦æ¨¡å¼æç¤º
                alert(`ğŸš€ æ¸¬è©¦æ¨¡å¼å·²å•Ÿå‹•ï¼\n\nå·²è‡ªå‹•å®Œæˆå‰${Math.min(17, questions.length)}é¡Œ\nç¾åœ¨è«‹æ‰‹å‹•å®Œæˆå‰©é¤˜é¡Œç›®`);
                
            } catch (error) {
                console.error('é–‹å§‹æ¸¬è©¦æ¨¡å¼å¤±æ•—:', error);
                alert('é–‹å§‹æ¸¬è©¦æ¨¡å¼å¤±æ•—ï¼Œè«‹é‡è©¦');
            }
        }

        // è‡ªå‹•ç­”é¡ŒåŠŸèƒ½
        function autoAnswerQuestions() {
            const interval = setInterval(() => {
                const question = questions[currentQuestion];
                let answer;
                
                if (question.question_type === 'multiple') {
                    // å¤šé¸é¡Œéš¨æ©Ÿé¸æ“‡1-3å€‹é¸é …
                    const numSelections = Math.floor(Math.random() * 3) + 1;
                    answer = [];
                    for (let i = 0; i < numSelections; i++) {
                        const randomOption = Math.floor(Math.random() * question.options.length);
                        if (!answer.includes(randomOption)) {
                            answer.push(randomOption);
                        }
                    }
                } else {
                    // å–®é¸é¡Œéš¨æ©Ÿé¸æ“‡ä¸€å€‹é¸é …
                    answer = Math.floor(Math.random() * question.options.length);
                }
                
                answers[currentQuestion] = answer;
                
                // æ›´æ–°UIé¡¯ç¤ºé¸ä¸­ç‹€æ…‹
                if (question.question_type === 'multiple') {
                    answer.forEach(optionIndex => {
                        const optionElement = document.querySelector(`[data-option="${optionIndex}"]`);
                        if (optionElement) {
                            optionElement.classList.add('selected');
                        }
                    });
                } else {
                    const optionElement = document.querySelector(`[data-option="${answer}"]`);
                    if (optionElement) {
                        optionElement.classList.add('selected');
                    }
                }
                
                updateProgress();
                
                setTimeout(() => {
                    if (currentQuestion < questions.length - 1) {
                        currentQuestion++;
                        displayQuestion();
                    } else {
                        clearInterval(interval);
                        submitQuiz();
                    }
                }, 1000);
            }, 1500);
        }

        // é¡¯ç¤ºå•é¡Œ
        function displayQuestion() {
            console.log('displayQuestionè¢«èª¿ç”¨ï¼ŒcurrentQuestion:', currentQuestion);
            console.log('questionsæ•¸çµ„:', questions);
            console.log('questionsé•·åº¦:', questions.length);
            
            if (!questions || questions.length === 0) {
                console.error('æ²’æœ‰å¯ç”¨çš„å•é¡Œæ•¸æ“š');
                alert('æ²’æœ‰å¯ç”¨çš„å•é¡Œæ•¸æ“š');
                return;
            }
            
            if (currentQuestion >= questions.length) {
                console.error('å•é¡Œç´¢å¼•è¶…å‡ºç¯„åœ');
                return;
            }
            
            const question = questions[currentQuestion];
            console.log('ç•¶å‰å•é¡Œ:', question);
            
            const container = document.getElementById('question-container');
            const info = document.getElementById('question-info');
            
            if (!container || !info) {
                console.error('æ‰¾ä¸åˆ°å•é¡Œå®¹å™¨å…ƒç´ ');
                return;
            }
            
            info.innerHTML = `ç¬¬ ${currentQuestion + 1} / ${questions.length} é¡Œ`;
            
            let optionsHtml = '';
            if (question.question_type === 'multiple') {
                optionsHtml = question.options.map((option, index) => {
                    // æª¢æŸ¥æ˜¯å¦æ˜¯ç¬¬18é¡Œçš„"å…¶å®ƒ"é¸é …
                    const isQuestion18 = currentQuestion === 17; // ç¬¬18é¡Œçš„ç´¢å¼•æ˜¯17
                    const isOtherOption = option === 'å…¶å®ƒ';
                    
                    if (isQuestion18 && isOtherOption) {
                        return `
                            <div class="option" data-option="${index}" onclick="selectMultipleOption(${index})">
                                <div class="option-number">${index + 1}</div>
                                <span>${option}</span>
                                <input type="text" id="other-input-${index}" placeholder="è«‹è¼¸å…¥å…¶ä»–æ”å½±é¡å‹..." 
                                       style="margin-left: 10px; padding: 5px; border: 1px solid #ddd; border-radius: 4px; width: 200px; font-size: 0.9em;"
                                       onclick="event.stopPropagation()" 
                                       onchange="handleOtherInput(${index}, this.value)">
                            </div>
                        `;
                    } else {
                        return `
                            <div class="option" data-option="${index}" onclick="selectMultipleOption(${index})">
                                <div class="option-number">${index + 1}</div>
                                <span>${option}</span>
                            </div>
                        `;
                    }
                }).join('');
            } else {
                optionsHtml = question.options.map((option, index) => `
                    <div class="option" data-option="${index}" onclick="selectOption(${index})">
                        <div class="option-number">${index + 1}</div>
                        <span>${option}</span>
                    </div>
                `).join('');
            }
            
            container.innerHTML = `
                <div class="question-card">
                    <div class="question-title">${question.content}</div>
                    ${question.question_type === 'multiple' ? '<p style="color: #666; margin-bottom: 15px;">ï¼ˆå¯å¤šé¸ï¼‰</p>' : ''}
                    <div class="options">
                        ${optionsHtml}
                    </div>
                </div>
            `;
            
            updateProgress();
            updateNavigation();
            
            // æ¢å¾©ä¹‹å‰çš„é¸æ“‡
            if (answers[currentQuestion] !== undefined && answers[currentQuestion] !== null) {
                if (question.question_type === 'multiple') {
                    if (Array.isArray(answers[currentQuestion])) {
                        answers[currentQuestion].forEach(optionIndex => {
                            const optionElement = document.querySelector(`[data-option="${optionIndex}"]`);
                            if (optionElement) {
                                optionElement.classList.add('selected');
                            }
                        });
                    }
                } else {
                    const optionElement = document.querySelector(`[data-option="${answers[currentQuestion]}"]`);
                    if (optionElement) {
                        optionElement.classList.add('selected');
                    }
                }
            }
        }

        // é¸æ“‡å–®é¸é¸é …
        function selectOption(optionIndex) {
            // æ¸…é™¤ä¹‹å‰çš„é¸æ“‡
            document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
            
            // é¸ä¸­ç•¶å‰é¸é …
            const optionElement = document.querySelector(`[data-option="${optionIndex}"]`);
            optionElement.classList.add('selected');
            
            answers[currentQuestion] = optionIndex;
            updateNavigation();
        }

        // é¸æ“‡å¤šé¸é¸é …
        function selectMultipleOption(optionIndex) {
            if (!answers[currentQuestion]) {
                answers[currentQuestion] = [];
            }
            
            const optionElement = document.querySelector(`[data-option="${optionIndex}"]`);
            const isSelected = optionElement.classList.contains('selected');
            
            if (isSelected) {
                optionElement.classList.remove('selected');
                answers[currentQuestion] = answers[currentQuestion].filter(i => i !== optionIndex);
            } else {
                optionElement.classList.add('selected');
                answers[currentQuestion].push(optionIndex);
            }
            
            updateNavigation();
        }

        // è™•ç†"å…¶å®ƒ"é¸é …çš„æ–‡å­—è¼¸å…¥
        function handleOtherInput(optionIndex, inputValue) {
            // ç¢ºä¿answersæ•¸çµ„å·²åˆå§‹åŒ–
            if (!answers[currentQuestion]) {
                answers[currentQuestion] = [];
            }
            
            // å¦‚æœæœ‰è¼¸å…¥å…§å®¹ï¼Œç¢ºä¿è©²é¸é …è¢«é¸ä¸­
            if (inputValue && inputValue.trim()) {
                const optionElement = document.querySelector(`[data-option="${optionIndex}"]`);
                if (!optionElement.classList.contains('selected')) {
                    optionElement.classList.add('selected');
                    if (!answers[currentQuestion].includes(optionIndex)) {
                        answers[currentQuestion].push(optionIndex);
                    }
                }
                
                // ä¿å­˜ç”¨æˆ¶è¼¸å…¥çš„æ–‡å­—
                if (!window.otherInputs) {
                    window.otherInputs = {};
                }
                window.otherInputs[`q${currentQuestion}_opt${optionIndex}`] = inputValue.trim();
            }
            
            updateNavigation();
        }

        // æ›´æ–°é€²åº¦æ¢
        function updateProgress() {
            const progress = ((currentQuestion + 1) / questions.length) * 100;
            document.getElementById('progress').style.width = progress + '%';
        }

        // æ›´æ–°å°èˆªæŒ‰éˆ•
        function updateNavigation() {
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            
            prevBtn.disabled = currentQuestion === 0;
            
            const hasAnswer = answers[currentQuestion] !== undefined && 
                             (Array.isArray(answers[currentQuestion]) ? 
                              answers[currentQuestion].length > 0 : true);
            
            if (currentQuestion === questions.length - 1) {
                nextBtn.textContent = hasAnswer ? 'å®Œæˆè©•ä¼°' : 'è«‹é¸æ“‡ç­”æ¡ˆ';
                nextBtn.disabled = !hasAnswer;
            } else {
                nextBtn.textContent = 'ä¸‹ä¸€é¡Œ â†’';
                nextBtn.disabled = !hasAnswer;
            }
        }

        // ä¸Šä¸€é¡Œ
        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                displayQuestion();
            }
        }

        // ä¸‹ä¸€é¡Œ
        function nextQuestion() {
            if (currentQuestion < questions.length - 1) {
                currentQuestion++;
                displayQuestion();
            } else {
                submitQuiz();
            }
        }

        // æäº¤å•å·
        async function submitQuiz() {
            try {
                // å°‡answerså°è±¡è½‰æ›ç‚ºæ•¸çµ„æ ¼å¼
                const answersArray = [];
                for (let i = 0; i < questions.length; i++) {
                    answersArray.push(answers[i]);
                }
                
                const submitData = {
                    answers: answersArray.map((answer, index) => ({
                        question_id: questions[index].id,
                        answer: answer
                    })),
                    // åŒ…å«"å…¶å®ƒ"é¸é …çš„æ–‡å­—è¼¸å…¥
                    other_inputs: window.otherInputs || {}
                };
                
                console.log('æäº¤æ•¸æ“š:', submitData); // èª¿è©¦ç”¨
                
                const response = await fetch('/api/submit', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(submitData)
                });
                
                if (!response.ok) {
                    const errorText = await response.text();
                    console.error('æäº¤å¤±æ•—ï¼Œæœå‹™å™¨éŸ¿æ‡‰:', errorText);
                    throw new Error(`HTTP ${response.status}: ${errorText}`);
                }
                
                const result = await response.json();
                displayResult(result);
            } catch (error) {
                console.error('æäº¤å¤±æ•—:', error);
                alert('æäº¤å¤±æ•—ï¼Œè«‹é‡è©¦');
            }
        }

        // é¡¯ç¤ºçµæœ
        function displayResult(result) {
            showPage('result');
            
            document.getElementById('score-display').innerHTML = `
                <div class="score-circle" style="background: ${result.level_color}">
                    ${result.score}/${result.max_score}
                </div>
                <p style="font-size: 1.2em; margin-bottom: 10px;">æ‚¨çš„å¾—åˆ†ï¼š${result.score} åˆ†ï¼ˆ${result.percentage}%ï¼‰</p>
            `;
            
            document.getElementById('level-display').innerHTML = `
                <div class="level-badge" style="background: ${result.level_color}">
                    ${result.level}
                </div>
            `;
            
            const coursesHtml = result.recommended_courses.map((course, index) => `
                <div class="course-card">
                    <div class="course-number">${index + 1}.</div>
                    <div class="course-content">
                        <div class="course-title">${course.title}</div>
                        <div class="course-meta">
                            <span class="course-category">${course.category}</span>
                            <span class="course-level">${course.level}</span>
                        </div>
                        <div class="course-description">${course.description}</div>
                    </div>
                </div>
            `).join('');
            
            document.getElementById('courses-display').innerHTML = `
                <div class="courses">
                    <h3>ğŸ¯ æ ¹æ“šæ‚¨çš„ç­”é¡Œè¡¨ç¾ï¼Œæˆ‘å€‘ç‚ºæ‚¨æ¨è–¦ä»¥ä¸‹èª²ç¨‹ï¼š</h3>
                    <div class="course-summary">
                        <p>ğŸ“Š æ‚¨çš„åˆ†æ•¸ï¼š${result.score}/${result.max_score} (${result.percentage}%)</p>
                        <p>ğŸ“ˆ æŠ€èƒ½ç­‰ç´šï¼š<span style="color: ${result.level_color}; font-weight: bold;">${result.level}</span></p>
                        <p>ğŸ“š æ¨è–¦èª²ç¨‹æ•¸é‡ï¼š${result.recommended_courses.length} å€‹</p>
                    </div>
                    ${coursesHtml}
                </div>
            `;
        }

        // é‡æ–°é–‹å§‹
        function restartQuiz() {
            currentQuestion = 0;
            answers = [];
            showHome();
        }

        // ç®¡ç†å“¡ç™»éŒ„
        async function adminLogin() {
            const username = document.getElementById('admin-username').value;
            const password = document.getElementById('admin-password').value;
            
            if (!username || !password) {
                alert('è«‹è¼¸å…¥ç”¨æˆ¶åå’Œå¯†ç¢¼');
                return;
            }
            
            try {
                const response = await fetch('/api/admin/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ username, password })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    showPage('admin-panel');
                    loadAdminStats();
                } else {
                    alert('ç™»éŒ„å¤±æ•—ï¼š' + (result.message || 'ç”¨æˆ¶åæˆ–å¯†ç¢¼éŒ¯èª¤'));
                }
            } catch (error) {
                console.error('ç™»éŒ„å¤±æ•—:', error);
                alert('ç™»éŒ„å¤±æ•—ï¼Œè«‹é‡è©¦');
            }
        }

        // ç®¡ç†å“¡ç™»å‡º
        async function adminLogout() {
            try {
                await fetch('/api/admin/logout', { method: 'POST' });
                showHome();
            } catch (error) {
                console.error('ç™»å‡ºå¤±æ•—:', error);
            }
        }
        
        // ==================== å³æ™‚æŸ¥çœ‹å›æ‡‰åŠŸèƒ½ ====================
        
        // è¼‰å…¥å³æ™‚çµ±è¨ˆæ•¸æ“š
        async function loadRealTimeStats() {
            try {
                const response = await fetch('/api/admin/real_time_stats');
                const data = await response.json();
                
                if (data.error) {
                    document.getElementById('real-time-stats-content').innerHTML = `
                        <p style="text-align: center; color: #dc3545; padding: 40px;">${data.error}</p>
                    `;
                    return;
                }
                
                // é¡¯ç¤ºç¸½å›æ‡‰æ•¸
                let html = `
                    <h2 style="font-size: 1.8em; margin-bottom: 20px; color: #333;">ç¸½å›æ‡‰æ•¸ï¼š${data.total_responses}</h2>
                `;
                
                // é¡¯ç¤ºå•é¡Œçµ±è¨ˆ - æŒ‰ç…§ç”¨æˆ¶è¦æ±‚çš„æ ¼å¼ï¼ˆä¸é¡¯ç¤ºæ­£ç¢ºç­”æ¡ˆæ¨™ç¤ºï¼‰
                data.question_stats.forEach(q => {
                    // åªç‚ºå‰17é¡ŒæŠ€è¡“è©•ä¼°é¡Œé¡¯ç¤ºç­”å°ç‡
                    if (q.order <= 17) {
                        html += `
                            <div class="question-detail" style="margin-bottom: 30px; padding: 15px; border: 1px solid #ddd; border-radius: 8px;">
                                <h3 style="font-size: 1.3em; margin-bottom: 10px; color: #333;">ç¬¬${q.order}é¡Œ: ${q.content}</h3>
                                <div style="font-size: 1.1em; margin-bottom: 5px;">ç­”å°ç‡${q.correct_rate}%</div>
                                <div style="font-size: 1.1em; margin-bottom: 10px; color: #666;">ç­”å°äººæ•¸: ${q.correct_answers} / ${q.total_answers}</div>
                                <div style="font-size: 1.1em; margin-bottom: 10px; font-weight: 600;">é¸é …é¸æ“‡çµ±è¨ˆ</div>
                        `;
                        
                        // ç‚ºæ¯å€‹é¸é …ç”Ÿæˆçµ±è¨ˆï¼ˆä¸é¡¯ç¤ºæ­£ç¢ºç­”æ¡ˆæ¨™ç¤ºï¼‰
                        q.option_stats.forEach((option, index) => {
                            html += `
                                <div style="
                                    padding: 5px 0; 
                                    font-size: 1.05em;
                                    color: #333;
                                ">
                                    ${index + 1}. ${option.option} ${option.percentage}% (${option.count})
                                </div>
                            `;
                        });
                        
                        html += `
                            </div>
                        `;
                    } else {
                        // ç¬¬18-19é¡Œèˆˆè¶£èª¿æŸ¥é¡Œçš„çµ±è¨ˆ
                        html += `
                            <div class="question-detail" style="margin-bottom: 30px; padding: 15px; border: 1px solid #ddd; border-radius: 8px;">
                                <h3 style="font-size: 1.3em; margin-bottom: 10px; color: #333;">ç¬¬${q.order}é¡Œ: ${q.content}</h3>
                                <div style="font-size: 1.1em; margin-bottom: 10px; font-weight: 600;">é¸é …é¸æ“‡çµ±è¨ˆ</div>
                        `;
                        
                        q.option_stats.forEach((option, index) => {
                            html += `
                                <div style="
                                    padding: 5px 0; 
                                    font-size: 1.05em;
                                    color: #333;
                                ">
                                    ${index + 1}. ${option.option} ${option.percentage}% (${option.count})
                                </div>
                            `;
                        });
                        
                        html += `
                            </div>
                        `;
                    }
                });
                
                document.getElementById('real-time-stats-content').innerHTML = html;
                
            } catch (error) {
                console.error('è¼‰å…¥å³æ™‚çµ±è¨ˆå¤±æ•—:', error);
                document.getElementById('real-time-stats-content').innerHTML = `
                    <p style="text-align: center; color: #dc3545; padding: 40px;">è¼‰å…¥å¤±æ•—ï¼Œè«‹é‡è©¦</p>
                `;
            }
        }
        
        // åˆ·æ–°å³æ™‚çµ±è¨ˆæ•¸æ“š
        function refreshRealTimeStats() {
            document.getElementById('real-time-stats-content').innerHTML = `
                <p style="text-align: center; color: #666; padding: 40px;">è¼‰å…¥ä¸­...</p>
            `;
            loadRealTimeStats();
        }
        
        // ç•¶åˆ‡æ›åˆ°å³æ™‚æŸ¥çœ‹å›æ‡‰é é¢æ™‚è‡ªå‹•è¼‰å…¥æ•¸æ“š
        function showAdminSection(section) {
            // æ›´æ–°èœå–®ç‹€æ…‹
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // æ‰¾åˆ°è¢«é»æ“Šçš„èœå–®é …ä¸¦è¨­ç‚ºæ´»èºç‹€æ…‹
            const clickedItem = document.querySelector(`[onclick="showAdminSection('${section}')"]`);
            if (clickedItem) {
                clickedItem.classList.add('active');
            }
            
            // é¡¯ç¤ºå°æ‡‰å…§å®¹
            document.querySelectorAll('.admin-content').forEach(content => {
                content.style.display = 'none';
            });
            
            const targetSection = document.getElementById(section);
            if (targetSection) {
                targetSection.style.display = 'block';
            }
            
            // è¼‰å…¥å°æ‡‰æ•¸æ“š
            if (section === 'dashboard') {
                loadAdminStats();
            } else if (section === 'detailed-stats') {
                loadDetailedStats();
            } else if (section === 'responses') {
                loadRealTimeStats();
            } else if (section === 'questions') {
                loadAdminQuestions();
            } else if (section === 'courses') {
                showCoursesListView(); // é»˜èªé¡¯ç¤ºèª²ç¨‹ç¸½è¦½
            } else if (section === 'score-settings') {
                loadScoreSettings();
            } else if (section === 'users') {
                loadAdminProfile();
            } else if (section === 'export') {
                // æ•¸æ“šå°å‡ºé é¢ä¸éœ€è¦ç‰¹æ®Šè¼‰å…¥
            }
        }

        // è¼‰å…¥ç®¡ç†å“¡çµ±è¨ˆ
        async function loadAdminStats() {
            try {
                const response = await fetch('/api/admin/stats');
                const data = await response.json();
                
                document.getElementById('stats-overview').innerHTML = `
                    <div class="stat-card">
                        <div class="stat-number">${data.total_responses}</div>
                        <div class="stat-label">ç¸½å›æ‡‰æ•¸</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${data.total_questions}</div>
                        <div class="stat-label">å•é¡Œç¸½æ•¸</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${data.avg_score}</div>
                        <div class="stat-label">å¹³å‡åˆ†æ•¸</div>
                    </div>
                `;
            } catch (error) {
                console.error('è¼‰å…¥çµ±è¨ˆå¤±æ•—:', error);
            }
        }

        // è¼‰å…¥è©³ç´°çµ±è¨ˆ
        async function loadDetailedStats() {
            try {
                const startDate = document.getElementById('start-date').value;
                const endDate = document.getElementById('end-date').value;
                
                let url = '/api/admin/detailed_stats';
                const params = new URLSearchParams();
                if (startDate) params.append('start_date', startDate);
                if (endDate) params.append('end_date', endDate);
                if (params.toString()) url += '?' + params.toString();
                
                const response = await fetch(url);
                const data = await response.json();
                
                // é¡¯ç¤ºç¸½å›æ‡‰æ•¸
                document.getElementById('total-responses').innerHTML = `
                    <h2 style="font-size: 1.8em; margin-bottom: 20px; color: #333;">ç¸½å›æ‡‰æ•¸ï¼š${data.total_responses}</h2>
                `;
                
                // é¡¯ç¤ºå•é¡Œçµ±è¨ˆ - æŒ‰ç…§ç”¨æˆ¶è¦æ±‚çš„ç²¾ç¢ºæ ¼å¼
                let questionStatsHtml = '';
                data.question_stats.forEach(q => {
                    // åªç‚ºå‰17é¡ŒæŠ€è¡“è©•ä¼°é¡Œé¡¯ç¤ºç­”å°ç‡
                    if (q.order <= 17) {
                        questionStatsHtml += `
                            <div class="question-detail" style="margin-bottom: 30px; padding: 15px; border: 1px solid #ddd; border-radius: 8px;">
                                <h3 style="font-size: 1.3em; margin-bottom: 10px; color: #333;">ç¬¬${q.order}é¡Œ: ${q.content}</h3>
                                <div style="font-size: 1.1em; margin-bottom: 5px;">ç­”å°ç‡${q.correct_rate}%</div>
                                <div style="font-size: 1.1em; margin-bottom: 10px; color: #666;">ç­”å°äººæ•¸: ${q.correct_answers} / ${q.total_answers}</div>
                                <div style="font-size: 1.1em; margin-bottom: 10px; font-weight: 600;">é¸é …é¸æ“‡çµ±è¨ˆ</div>
                        `;
                        
                        // ç‚ºæ¯å€‹é¸é …ç”Ÿæˆçµ±è¨ˆï¼ŒæŒ‰ç…§ç”¨æˆ¶è¦æ±‚çš„ç²¾ç¢ºæ ¼å¼
                        q.option_stats.forEach((option, index) => {
                            const isCorrect = index === (q.correct_answer || 0);
                            const correctMark = isCorrect ? ' âœ…' : '';
                            
                            questionStatsHtml += `
                                <div style="
                                    padding: 5px 0; 
                                    font-size: 1.05em;
                                    color: #333;
                                ">
                                    ${index + 1}. ${option.option}${correctMark} ${option.percentage}% (${option.count})
                                </div>
                            `;
                        });
                        
                        questionStatsHtml += `
                            </div>
                        `;
                    } else {
                        // ç¬¬18-19é¡Œèˆˆè¶£èª¿æŸ¥é¡Œçš„çµ±è¨ˆ
                        questionStatsHtml += `
                            <div class="question-detail" style="margin-bottom: 30px; padding: 15px; border: 1px solid #ddd; border-radius: 8px;">
                                <h3 style="font-size: 1.3em; margin-bottom: 10px; color: #333;">ç¬¬${q.order}é¡Œ: ${q.content}</h3>
                                <div style="font-size: 1.1em; margin-bottom: 10px; font-weight: 600;">é¸é …é¸æ“‡çµ±è¨ˆ</div>
                        `;
                        
                        q.option_stats.forEach((option, index) => {
                            questionStatsHtml += `
                                <div style="
                                    padding: 5px 0; 
                                    font-size: 1.05em;
                                    color: #333;
                                ">
                                    ${index + 1}. ${option.option} ${option.percentage}% (${option.count})
                                </div>
                            `;
                        });
                        
                        questionStatsHtml += `
                            </div>
                        `;
                    }
                });
                
                document.getElementById('question-stats').innerHTML = questionStatsHtml;
                
                // é¡¯ç¤ºåˆ†æ•¸åˆ†å¸ƒ
                let scoreDistributionHtml = '<h3 style="font-size: 1.4em; margin-bottom: 20px; color: #333;">åˆ†æ•¸åˆ†å¸ƒçµ±è¨ˆï¼ˆ0-17åˆ†ï¼‰</h3>';
                scoreDistributionHtml += '<div style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: center;">';
                
                data.score_distribution.forEach(score => {
                    const barHeight = Math.max(score.percentage * 3, 10); // æœ€å°é«˜åº¦10px
                    scoreDistributionHtml += `
                        <div style="
                            display: flex; 
                            flex-direction: column; 
                            align-items: center; 
                            margin: 5px;
                            min-width: 40px;
                        ">
                            <div style="
                                width: 30px; 
                                height: ${barHeight}px; 
                                background-color: #4CAF50; 
                                border-radius: 3px;
                                margin-bottom: 5px;
                            "></div>
                            <div style="font-size: 0.9em; font-weight: 600;">${score.score}åˆ†</div>
                            <div style="font-size: 0.8em; color: #666; text-align: center;">
                                ${score.percentage}%<br>(${score.count})
                            </div>
                        </div>
                    `;
                });
                
                scoreDistributionHtml += '</div>';
                
                document.getElementById('score-distribution').innerHTML = `
                    <div class="score-distribution" style="margin-top: 30px; padding: 20px; border: 1px solid #ddd; border-radius: 8px;">
                        ${scoreDistributionHtml}
                    </div>
                `;
                
            } catch (error) {
                console.error('è¼‰å…¥è©³ç´°çµ±è¨ˆå¤±æ•—:', error);
            }
        }

        // ç¯©é¸æ•¸æ“š
        function filterData() {
            loadDetailedStats();
        }

        // æ¸…é™¤ç¯©é¸
        function clearFilter() {
            document.getElementById('start-date').value = '';
            document.getElementById('end-date').value = '';
            loadDetailedStats();
        }

        // æŒ‰æ—¥æœŸæ¸…é™¤æ•¸æ“š
        async function clearDataByDate() {
            const startDate = document.getElementById('clear-start-date').value;
            const endDate = document.getElementById('clear-end-date').value;
            
            if (!startDate && !endDate) {
                alert('è«‹é¸æ“‡è¦æ¸…é™¤çš„æ—¥æœŸç¯„åœ');
                return;
            }
            
            if (!confirm('ç¢ºå®šè¦æ¸…é™¤é¸å®šæ—¥æœŸç¯„åœçš„æ•¸æ“šå—ï¼Ÿæ­¤æ“ä½œç„¡æ³•æ’¤éŠ·ã€‚')) {
                return;
            }
            
            try {
                const response = await fetch('/api/admin/clear_data', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        start_date: startDate,
                        end_date: endDate
                    })
                });
                
                const result = await response.json();
                if (result.success) {
                    alert('æ•¸æ“šæ¸…é™¤æˆåŠŸ');
                    loadDetailedStats();
                    loadAdminStats();
                } else {
                    alert('æ•¸æ“šæ¸…é™¤å¤±æ•—');
                }
            } catch (error) {
                console.error('æ¸…é™¤æ•¸æ“šå¤±æ•—:', error);
                alert('æ¸…é™¤æ•¸æ“šå¤±æ•—ï¼Œè«‹é‡è©¦');
            }
        }

        // æ¸…é™¤æ‰€æœ‰æ•¸æ“š
        async function clearAllData() {
            if (!confirm('ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰æ•¸æ“šå—ï¼Ÿæ­¤æ“ä½œç„¡æ³•æ’¤éŠ·ã€‚')) {
                return;
            }
            
            try {
                const response = await fetch('/api/admin/clear_data', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        clear_all: true
                    })
                });
                
                const result = await response.json();
                if (result.success) {
                    alert('æ‰€æœ‰æ•¸æ“šæ¸…é™¤æˆåŠŸ');
                    loadDetailedStats();
                    loadAdminStats();
                } else {
                    alert('æ•¸æ“šæ¸…é™¤å¤±æ•—');
                }
            } catch (error) {
                console.error('æ¸…é™¤æ•¸æ“šå¤±æ•—:', error);
                alert('æ¸…é™¤æ•¸æ“šå¤±æ•—ï¼Œè«‹é‡è©¦');
            }
        }

        // ==================== å•é¡Œç®¡ç†åŠŸèƒ½ ====================
        
        let currentEditingQuestion = null;
        
        // è¼‰å…¥å•é¡Œåˆ—è¡¨ï¼ˆç®¡ç†å“¡ç”¨ï¼‰
        async function loadAdminQuestions() {
            try {
                const response = await fetch('/api/admin/questions');
                const questionsData = await response.json();
                
                const container = document.getElementById('questions-list');
                container.innerHTML = questionsData.map(q => `
                    <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 15px; border-left: 4px solid #667eea;">
                        <div style="display: flex; justify-content: between; align-items: flex-start;">
                            <div style="flex: 1;">
                                <h4 style="margin-bottom: 10px;">ç¬¬${q.order}é¡Œ: ${q.content}</h4>
                                <p style="color: #666; margin-bottom: 10px;">é¡å‹: ${q.question_type === 'single' ? 'å–®é¸é¡Œ' : 'å¤šé¸é¡Œ'}</p>
                                <div style="margin-bottom: 10px;">
                                    ${q.options.map((option, index) => `
                                        <div style="margin-bottom: 5px;">
                                            ${index + 1}. ${option} ${q.correct_answer === index || (Array.isArray(q.correct_answer) && q.correct_answer.includes(index)) ? 'âœ…' : ''}
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                            <div style="margin-left: 20px;">
                                <button onclick="editQuestion(${q.id})" style="margin-right: 10px; padding: 5px 15px; background: #667eea; color: white; border: none; border-radius: 5px;">ç·¨è¼¯</button>
                                <button onclick="deleteQuestion(${q.id})" style="padding: 5px 15px; background: #f44336; color: white; border: none; border-radius: 5px;">åˆªé™¤</button>
                            </div>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                alert('è¼‰å…¥å•é¡Œå¤±æ•—');
            }
        }
        
        // é¡¯ç¤ºæ·»åŠ å•é¡Œæ¨¡æ…‹æ¡†
        function showAddQuestionModal() {
            currentEditingQuestion = null;
            document.getElementById('question-modal-title').textContent = 'æ·»åŠ æ–°å•é¡Œ';
            document.getElementById('question-content').value = '';
            document.getElementById('question-type').value = 'single';
            
            // æ¸…ç©ºé¸é …
            const optionsContainer = document.getElementById('question-options');
            optionsContainer.innerHTML = '';
            
            // æ·»åŠ é»˜èªé¸é …
            for (let i = 0; i < 4; i++) {
                addQuestionOption();
            }
            
            updateCorrectAnswerSection();
            document.getElementById('question-modal').style.display = 'block';
        }
        
        // ç·¨è¼¯å•é¡Œ
        async function editQuestion(questionId) {
            try {
                const response = await fetch('/api/admin/questions');
                const questions = await response.json();
                const question = questions.find(q => q.id === questionId);
                
                if (!question) return;
                
                currentEditingQuestion = question;
                document.getElementById('question-modal-title').textContent = 'ç·¨è¼¯å•é¡Œ';
                document.getElementById('question-content').value = question.content;
                document.getElementById('question-type').value = question.question_type;
                
                // è¼‰å…¥é¸é …
                const optionsContainer = document.getElementById('question-options');
                optionsContainer.innerHTML = '';
                
                question.options.forEach(option => {
                    addQuestionOption(option);
                });
                
                updateCorrectAnswerSection();
                
                // è¨­ç½®æ­£ç¢ºç­”æ¡ˆ
                if (question.question_type === 'single') {
                    if (question.correct_answer !== null && question.correct_answer !== undefined) {
                        const radio = document.querySelector(`input[name="correct-answer"][value="${question.correct_answer}"]`);
                        if (radio) radio.checked = true;
                    }
                } else {
                    if (question.correct_answer && Array.isArray(question.correct_answer)) {
                        question.correct_answer.forEach(index => {
                            const checkbox = document.querySelector(`input[name="correct-answer"][value="${index}"]`);
                            if (checkbox) checkbox.checked = true;
                        });
                    }
                }
                
                document.getElementById('question-modal').style.display = 'block';
            } catch (error) {
                alert('è¼‰å…¥å•é¡Œå¤±æ•—');
            }
        }
        
        // æ·»åŠ å•é¡Œé¸é …
        function addQuestionOption(value = '') {
            const optionsContainer = document.getElementById('question-options');
            const index = optionsContainer.children.length;
            
            const optionDiv = document.createElement('div');
            optionDiv.style.cssText = 'display: flex; margin-bottom: 10px; align-items: center;';
            optionDiv.innerHTML = `
                <span style="margin-right: 10px; width: 30px;">${index + 1}.</span>
                <input type="text" value="${value}" style="flex: 1; padding: 8px; border: 1px solid #ddd; border-radius: 5px; margin-right: 10px;">
                <button type="button" onclick="removeQuestionOption(this)" style="padding: 5px 10px; background: #f44336; color: white; border: none; border-radius: 5px;">åˆªé™¤</button>
            `;
            
            optionsContainer.appendChild(optionDiv);
            updateCorrectAnswerSection();
        }
        
        // ç§»é™¤å•é¡Œé¸é …
        function removeQuestionOption(button) {
            button.parentElement.remove();
            updateCorrectAnswerSection();
            
            // é‡æ–°ç·¨è™Ÿ
            const optionsContainer = document.getElementById('question-options');
            Array.from(optionsContainer.children).forEach((div, index) => {
                div.querySelector('span').textContent = `${index + 1}.`;
            });
        }
        
        // æ›´æ–°æ­£ç¢ºç­”æ¡ˆé¸æ“‡å€åŸŸ
        function updateCorrectAnswerSection() {
            const questionType = document.getElementById('question-type').value;
            const optionsContainer = document.getElementById('question-options');
            const correctAnswerSection = document.getElementById('correct-answer-section');
            
            const options = Array.from(optionsContainer.children);
            
            if (questionType === 'single') {
                correctAnswerSection.innerHTML = options.map((_, index) => `
                    <label style="display: block; margin-bottom: 5px;">
                        <input type="radio" name="correct-answer" value="${index}" style="margin-right: 10px;">
                        é¸é … ${index + 1}
                    </label>
                `).join('');
            } else {
                correctAnswerSection.innerHTML = options.map((_, index) => `
                    <label style="display: block; margin-bottom: 5px;">
                        <input type="checkbox" name="correct-answer" value="${index}" style="margin-right: 10px;">
                        é¸é … ${index + 1}
                    </label>
                `).join('');
            }
        }
        
        // ç›£è½å•é¡Œé¡å‹è®ŠåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            const questionTypeSelect = document.getElementById('question-type');
            if (questionTypeSelect) {
                questionTypeSelect.addEventListener('change', updateCorrectAnswerSection);
            }
        });
        
        // ä¿å­˜å•é¡Œ
        async function saveQuestion() {
            const content = document.getElementById('question-content').value.trim();
            const questionType = document.getElementById('question-type').value;
            
            if (!content) {
                alert('è«‹è¼¸å…¥å•é¡Œå…§å®¹');
                return;
            }
            
            // ç²å–é¸é …
            const optionsContainer = document.getElementById('question-options');
            const options = Array.from(optionsContainer.children).map(div => 
                div.querySelector('input[type="text"]').value.trim()
            ).filter(option => option);
            
            if (options.length < 2) {
                alert('è‡³å°‘éœ€è¦2å€‹é¸é …');
                return;
            }
            
            // ç²å–æ­£ç¢ºç­”æ¡ˆ
            let correctAnswer;
            if (questionType === 'single') {
                const checkedRadio = document.querySelector('input[name="correct-answer"]:checked');
                if (!checkedRadio) {
                    alert('è«‹é¸æ“‡æ­£ç¢ºç­”æ¡ˆ');
                    return;
                }
                correctAnswer = parseInt(checkedRadio.value);
            } else {
                const checkedCheckboxes = document.querySelectorAll('input[name="correct-answer"]:checked');
                if (checkedCheckboxes.length === 0) {
                    alert('è«‹é¸æ“‡è‡³å°‘ä¸€å€‹æ­£ç¢ºç­”æ¡ˆ');
                    return;
                }
                correctAnswer = Array.from(checkedCheckboxes).map(cb => parseInt(cb.value));
            }
            
            const questionData = {
                content,
                question_type: questionType,
                options,
                correct_answer: correctAnswer
            };
            
            try {
                let response;
                if (currentEditingQuestion) {
                    response = await fetch(`/api/admin/questions/${currentEditingQuestion.id}`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(questionData)
                    });
                } else {
                    response = await fetch('/api/admin/questions', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(questionData)
                    });
                }
                
                if (response.ok) {
                    closeQuestionModal();
                    loadQuestions();
                    alert(currentEditingQuestion ? 'å•é¡Œæ›´æ–°æˆåŠŸ' : 'å•é¡Œæ·»åŠ æˆåŠŸ');
                } else {
                    alert('ä¿å­˜å¤±æ•—ï¼Œè«‹é‡è©¦');
                }
            } catch (error) {
                alert('ä¿å­˜å¤±æ•—ï¼Œè«‹é‡è©¦');
            }
        }
        
        // åˆªé™¤å•é¡Œ
        async function deleteQuestion(questionId) {
            if (!confirm('ç¢ºå®šè¦åˆªé™¤é€™å€‹å•é¡Œå—ï¼Ÿé€™å°‡åŒæ™‚åˆªé™¤ç›¸é—œçš„å›æ‡‰æ•¸æ“šã€‚')) {
                return;
            }
            
            try {
                const response = await fetch(`/api/admin/questions/${questionId}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    loadQuestions();
                    alert('å•é¡Œåˆªé™¤æˆåŠŸ');
                } else {
                    alert('åˆªé™¤å¤±æ•—ï¼Œè«‹é‡è©¦');
                }
            } catch (error) {
                alert('åˆªé™¤å¤±æ•—ï¼Œè«‹é‡è©¦');
            }
        }
        
        // é—œé–‰å•é¡Œæ¨¡æ…‹æ¡†
        function closeQuestionModal() {
            document.getElementById('question-modal').style.display = 'none';
        }
        
        // ==================== èª²ç¨‹ç®¡ç†åŠŸèƒ½ ====================
        
        let currentEditingCourse = null;
        
        // è¼‰å…¥èª²ç¨‹åˆ—è¡¨
        async function loadCourses() {
            try {
                const response = await fetch('/api/admin/courses');
                const courses = await response.json();
                
                const container = document.getElementById('courses-list');
                container.innerHTML = courses.map(c => `
                    <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 15px; border-left: 4px solid ${c.is_active ? '#667eea' : '#ccc'}; ${!c.is_active ? 'opacity: 0.6;' : ''}">
                        <div style="display: flex; justify-content: between; align-items: flex-start;">
                            <div style="flex: 1;">
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                    <h4 style="margin: 0;">${c.title}</h4>
                                    <span style="background: ${c.is_active ? '#4caf50' : '#f44336'}; color: white; padding: 2px 8px; border-radius: 12px; font-size: 0.8em;">
                                        ${c.is_active ? 'é–‹å•Ÿ' : 'é—œé–‰'}
                                    </span>
                                </div>
                                <p style="color: #666; margin-bottom: 10px;">${c.description}</p>
                                <div style="display: flex; gap: 15px; margin-bottom: 10px;">
                                    <span style="background: #e3f2fd; color: #1976d2; padding: 4px 12px; border-radius: 15px; font-size: 0.9em;">${c.category}</span>
                                    <span style="background: #f3e5f5; color: #7b1fa2; padding: 4px 12px; border-radius: 15px; font-size: 0.9em;">${c.level}</span>
                                </div>
                                ${c.interest_tags && c.interest_tags.length > 0 ? `
                                    <div style="margin-top: 8px;">
                                        <small style="color: #666;">èˆˆè¶£é—œè¯: </small>
                                        ${c.interest_tags.slice(0, 3).map(tag => `<span style="background: #fff3e0; color: #f57c00; padding: 2px 6px; border-radius: 8px; font-size: 0.8em; margin-right: 5px;">${tag}</span>`).join('')}
                                        ${c.interest_tags.length > 3 ? `<span style="color: #666; font-size: 0.8em;">ç­‰${c.interest_tags.length}é …</span>` : ''}
                                    </div>
                                ` : ''}
                            </div>
                            <div style="margin-left: 20px;">
                                <button onclick="editCourse(${c.id})" style="margin-right: 10px; padding: 5px 15px; background: #667eea; color: white; border: none; border-radius: 5px;">ç·¨è¼¯</button>
                                <button onclick="deleteCourse(${c.id})" style="padding: 5px 15px; background: #f44336; color: white; border: none; border-radius: 5px;">åˆªé™¤</button>
                            </div>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                alert('è¼‰å…¥èª²ç¨‹å¤±æ•—');
            }
        }
        
        // é¡¯ç¤ºæ·»åŠ èª²ç¨‹æ¨¡æ…‹æ¡†
        function showAddCourseModal() {
            currentEditingCourse = null;
            document.getElementById('course-modal-title').textContent = 'æ·»åŠ æ–°èª²ç¨‹';
            document.getElementById('course-title').value = '';
            document.getElementById('course-description').value = '';
            document.getElementById('course-category').value = 'æ–°æ‰‹å…¥é–€';
            document.getElementById('course-level').value = 'æ”å½±æ–°æ‰‹';
            document.getElementById('course-active').checked = true;
            
            // åˆå§‹åŒ–èˆˆè¶£æ¨™ç±¤é¸é …
            initializeInterestTags();
            
            document.getElementById('course-modal').style.display = 'block';
        }
        
        // åˆå§‹åŒ–èˆˆè¶£æ¨™ç±¤é¸é …
        function initializeInterestTags(selectedTags = []) {
            const interestOptions = [
                'åŸºæœ¬æ”å½±çŸ¥è­˜ (å…‰åœˆï¼Œå¿«é–€ï¼ŒISOï¼Œæ›å…‰è£œå„Ÿ)',
                'åŸºæœ¬ç›¸æ©Ÿæ“ä½œæ•™å­¸',
                'é«˜éšç›¸æ©Ÿæ“ä½œæ•™å­¸ (è‡ªè¨‚åŠŸèƒ½è¨­å®š)',
                'äººç‰©æ”å½±ï¼ˆå€‹äºº / å®¶åº­/ å°å­©ï¼‰',
                'äººç‰©æ”å½±ï¼ˆæƒ…ä¾¶ï¼‰',
                'äººåƒæ”å½±ï¼ˆæ¨¡ç‰¹å…’ï¼‰',
                'é¢¨æ™¯æ”å½± (é¢¨å…‰)',
                'é¢¨æ™¯æ”å½± (æ—…è¡Œæ‰“å¡)',
                'é¢¨æ™¯æ”å½± (å¤œæ™¯)',
                'é¢¨æ™¯æ”å½± (åŒ—æ¥µå…‰)',
                'é¢¨æ™¯æ”å½± (å¤©æ–‡)',
                'åŸå¸‚æ”å½± (å»ºç¯‰)',
                'ç¸®æ™‚æ”å½± (Timelapse)',
                'ç”Ÿæ…‹æ”å½± (å‹•ç‰©å¤§é·å¾™)',
                'ç”Ÿæ…‹æ”å½± (é³¥æ”)',
                'ç”Ÿæ…‹æ”å½± (èŠ±)',
                'ç”Ÿæ…‹æ”å½± (æ˜†èŸ²)',
                'èˆå°æ”å½± (æ¼”å”±æœƒ/ å°ä¸Šè¡¨æ¼”/ ç²µåŠ‡)',
                'è¡—æ‹æ”å½± (äººæ°‘ç”Ÿæ´»ç´€éŒ„)',
                'æ´»å‹•æ”å½± (å…¬å¸å‘¨å¹´æ™šæœƒ/ å©šå®´)',
                'å•†æ¥­æ”å½± (ç”¢å“)',
                'å¯µç‰©æ”å½±ï¼ˆè²“ / ç‹— / å…¶ä»–å¯µç‰©ï¼‰',
                'é‹å‹•æ”å½±',
                'æ±½è»Šæ”å½± (äº¤é€šå·¥å…·å¦‚å·´å£«/åœ°éµ/ é›»è»Š)',
                'æ±½è»Šæ”å½± (å…¬è·¯æ±½è»Š / è³½è»Š)',
                'å¯µç‰©æ”å½±',
                'åŸ·ç›¸æ•™å­¸ (å¾Œè£½ä¿®åœ–)',
                'æ‹ç‰‡çŸ¥è­˜ (æ‹æ”çŸ­ç‰‡)',
                'å…¶å®ƒ',
                // é ç•™ç©ºç™½ä½ç½®ä¾›æœªä¾†æ“´å±•
                'ã€é ç•™ã€‘æ‹æ”é¡Œæ1',
                'ã€é ç•™ã€‘æ‹æ”é¡Œæ2',
                'ã€é ç•™ã€‘æ‹æ”é¡Œæ3',
                'ã€é ç•™ã€‘æ‹æ”é¡Œæ4',
                'ã€é ç•™ã€‘æ‹æ”é¡Œæ5'
            ];
            
            const container = document.getElementById('interest-tags-container');
            container.innerHTML = interestOptions.map(option => `
                <label style="display: block; margin-bottom: 8px; cursor: pointer; ${option.includes('ã€é ç•™ã€‘') ? 'opacity: 0.6; font-style: italic;' : ''}">
                    <input type="checkbox" value="${option}" ${selectedTags.includes(option) ? 'checked' : ''} style="margin-right: 8px;">
                    <span style="font-size: 0.9em;">${option}</span>
                </label>
            `).join('');
        }
        
        // ç·¨è¼¯èª²ç¨‹
        async function editCourse(courseId) {
            try {
                const response = await fetch('/api/admin/courses');
                const courses = await response.json();
                const course = courses.find(c => c.id === courseId);
                
                if (!course) return;
                
                currentEditingCourse = course;
                document.getElementById('course-modal-title').textContent = 'ç·¨è¼¯èª²ç¨‹';
                document.getElementById('course-title').value = course.title;
                document.getElementById('course-description').value = course.description;
                document.getElementById('course-category').value = course.category;
                document.getElementById('course-level').value = course.level;
                document.getElementById('course-active').checked = course.is_active !== false;
                
                // åˆå§‹åŒ–èˆˆè¶£æ¨™ç±¤é¸é …ï¼Œä¸¦è¨­ç½®å·²é¸ä¸­çš„æ¨™ç±¤
                const selectedTags = course.interest_tags || [];
                initializeInterestTags(selectedTags);
                
                document.getElementById('course-modal').style.display = 'block';
            } catch (error) {
                alert('è¼‰å…¥èª²ç¨‹å¤±æ•—');
            }
        }
        
        // ä¿å­˜èª²ç¨‹
        async function saveCourse() {
            const title = document.getElementById('course-title').value.trim();
            const description = document.getElementById('course-description').value.trim();
            const category = document.getElementById('course-category').value;
            const level = document.getElementById('course-level').value;
            const isActive = document.getElementById('course-active').checked;
            
            // ç²å–é¸ä¸­çš„èˆˆè¶£æ¨™ç±¤
            const selectedTags = Array.from(document.querySelectorAll('#interest-tags-container input[type="checkbox"]:checked'))
                .map(checkbox => checkbox.value);
            
            if (!title || !description) {
                alert('è«‹å¡«å¯«èª²ç¨‹æ¨™é¡Œå’Œæè¿°');
                return;
            }
            
            const courseData = { 
                title, 
                description, 
                category, 
                level, 
                is_active: isActive,
                interest_tags: selectedTags
            };
            
            try {
                let response;
                if (currentEditingCourse) {
                    response = await fetch(`/api/admin/courses/${currentEditingCourse.id}`, {
                        method: 'PUT',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(courseData)
                    });
                } else {
                    response = await fetch('/api/admin/courses', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(courseData)
                    });
                }
                
                if (response.ok) {
                    closeCourseModal();
                    loadCourses();
                    alert(currentEditingCourse ? 'èª²ç¨‹æ›´æ–°æˆåŠŸ' : 'èª²ç¨‹æ·»åŠ æˆåŠŸ');
                } else {
                    alert('ä¿å­˜å¤±æ•—ï¼Œè«‹é‡è©¦');
                }
            } catch (error) {
                alert('ä¿å­˜å¤±æ•—ï¼Œè«‹é‡è©¦');
            }
        }
        
        // åˆªé™¤èª²ç¨‹
        async function deleteCourse(courseId) {
            if (!confirm('ç¢ºå®šè¦åˆªé™¤é€™å€‹èª²ç¨‹å—ï¼Ÿ')) {
                return;
            }
            
            try {
                const response = await fetch(`/api/admin/courses/${courseId}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    loadCourses();
                    alert('èª²ç¨‹åˆªé™¤æˆåŠŸ');
                } else {
                    alert('åˆªé™¤å¤±æ•—ï¼Œè«‹é‡è©¦');
                }
            } catch (error) {
                alert('åˆªé™¤å¤±æ•—ï¼Œè«‹é‡è©¦');
            }
        }
        
        // ==================== æ–°çš„èª²ç¨‹ç®¡ç†ç•Œé¢å‡½æ•¸ ====================
        
        // é¡¯ç¤ºèª²ç¨‹ç¸½è¦½
        function showCoursesListView() {
            document.getElementById('courses-list-view').style.display = 'block';
            document.getElementById('edit-course-selection').style.display = 'none';
            document.getElementById('delete-course-selection').style.display = 'none';
            loadCourses();
        }
        
        // é¡¯ç¤ºç·¨è¼¯èª²ç¨‹é¸æ“‡ç•Œé¢
        function showEditCourseSelection() {
            document.getElementById('courses-list-view').style.display = 'none';
            document.getElementById('edit-course-selection').style.display = 'block';
            document.getElementById('delete-course-selection').style.display = 'none';
            loadEditCoursesList();
        }
        
        // é¡¯ç¤ºåˆªé™¤èª²ç¨‹é¸æ“‡ç•Œé¢
        function showDeleteCourseSelection() {
            document.getElementById('courses-list-view').style.display = 'none';
            document.getElementById('edit-course-selection').style.display = 'none';
            document.getElementById('delete-course-selection').style.display = 'block';
            loadDeleteCoursesList();
        }
        
        // è¼‰å…¥å¯ç·¨è¼¯èª²ç¨‹åˆ—è¡¨
        async function loadEditCoursesList() {
            try {
                const response = await fetch('/api/admin/courses');
                const courses = await response.json();
                
                const container = document.getElementById('edit-courses-list');
                if (courses.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: #666; padding: 40px;">æš«ç„¡èª²ç¨‹å¯ç·¨è¼¯</p>';
                    return;
                }
                
                container.innerHTML = courses.map(c => `
                    <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 15px; border-left: 4px solid #007bff; cursor: pointer; transition: all 0.3s ease;" 
                         onclick="editCourse(${c.id})" 
                         onmouseover="this.style.boxShadow='0 4px 12px rgba(0,123,255,0.15)'; this.style.transform='translateY(-2px)'"
                         onmouseout="this.style.boxShadow='none'; this.style.transform='translateY(0)'">
                        <div style="display: flex; justify-content: between; align-items: flex-start;">
                            <div style="flex: 1;">
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                    <h4 style="margin: 0;">${c.title}</h4>
                                    <span style="background: ${c.is_active ? '#4caf50' : '#f44336'}; color: white; padding: 2px 8px; border-radius: 12px; font-size: 0.8em;">
                                        ${c.is_active ? 'é–‹å•Ÿ' : 'é—œé–‰'}
                                    </span>
                                </div>
                                <p style="color: #666; margin-bottom: 10px;">${c.description}</p>
                                <div style="display: flex; gap: 15px; margin-bottom: 10px;">
                                    <span style="background: #e3f2fd; color: #1976d2; padding: 4px 12px; border-radius: 15px; font-size: 0.9em;">${c.category}</span>
                                    <span style="background: #f3e5f5; color: #7b1fa2; padding: 4px 12px; border-radius: 15px; font-size: 0.9em;">${c.level}</span>
                                </div>
                                ${c.interest_tags && c.interest_tags.length > 0 ? `
                                    <div style="margin-top: 8px;">
                                        <small style="color: #666;">èˆˆè¶£é—œè¯: </small>
                                        ${c.interest_tags.slice(0, 3).map(tag => `<span style="background: #fff3e0; color: #f57c00; padding: 2px 6px; border-radius: 8px; font-size: 0.8em; margin-right: 5px;">${tag}</span>`).join('')}
                                        ${c.interest_tags.length > 3 ? `<span style="color: #666; font-size: 0.8em;">ç­‰${c.interest_tags.length}é …</span>` : ''}
                                    </div>
                                ` : ''}
                            </div>
                            <div style="margin-left: 20px;">
                                <span style="color: #007bff; font-size: 1.2em;">âœï¸</span>
                            </div>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                document.getElementById('edit-courses-list').innerHTML = '<p style="text-align: center; color: #f44336; padding: 40px;">è¼‰å…¥èª²ç¨‹å¤±æ•—</p>';
            }
        }
        
        // è¼‰å…¥å¯åˆªé™¤èª²ç¨‹åˆ—è¡¨
        async function loadDeleteCoursesList() {
            try {
                const response = await fetch('/api/admin/courses');
                const courses = await response.json();
                
                const container = document.getElementById('delete-courses-list');
                if (courses.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: #666; padding: 40px;">æš«ç„¡èª²ç¨‹å¯åˆªé™¤</p>';
                    return;
                }
                
                container.innerHTML = courses.map(c => `
                    <div style="background: white; padding: 20px; border-radius: 10px; margin-bottom: 15px; border-left: 4px solid #dc3545;">
                        <div style="display: flex; justify-content: between; align-items: flex-start;">
                            <div style="flex: 1;">
                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                                    <h4 style="margin: 0;">${c.title}</h4>
                                    <span style="background: ${c.is_active ? '#4caf50' : '#f44336'}; color: white; padding: 2px 8px; border-radius: 12px; font-size: 0.8em;">
                                        ${c.is_active ? 'é–‹å•Ÿ' : 'é—œé–‰'}
                                    </span>
                                </div>
                                <p style="color: #666; margin-bottom: 10px;">${c.description}</p>
                                <div style="display: flex; gap: 15px; margin-bottom: 10px;">
                                    <span style="background: #e3f2fd; color: #1976d2; padding: 4px 12px; border-radius: 15px; font-size: 0.9em;">${c.category}</span>
                                    <span style="background: #f3e5f5; color: #7b1fa2; padding: 4px 12px; border-radius: 15px; font-size: 0.9em;">${c.level}</span>
                                </div>
                                ${c.interest_tags && c.interest_tags.length > 0 ? `
                                    <div style="margin-top: 8px;">
                                        <small style="color: #666;">èˆˆè¶£é—œè¯: </small>
                                        ${c.interest_tags.slice(0, 3).map(tag => `<span style="background: #fff3e0; color: #f57c00; padding: 2px 6px; border-radius: 8px; font-size: 0.8em; margin-right: 5px;">${tag}</span>`).join('')}
                                        ${c.interest_tags.length > 3 ? `<span style="color: #666; font-size: 0.8em;">ç­‰${c.interest_tags.length}é …</span>` : ''}
                                    </div>
                                ` : ''}
                            </div>
                            <div style="margin-left: 20px;">
                                <button onclick="deleteCourse(${c.id})" style="padding: 8px 16px; background: #dc3545; color: white; border: none; border-radius: 5px; cursor: pointer; transition: all 0.3s ease;"
                                        onmouseover="this.style.background='#c82333'"
                                        onmouseout="this.style.background='#dc3545'">
                                    ğŸ—‘ï¸ åˆªé™¤
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                document.getElementById('delete-courses-list').innerHTML = '<p style="text-align: center; color: #f44336; padding: 40px;">è¼‰å…¥èª²ç¨‹å¤±æ•—</p>';
            }
        }
        
        // é—œé–‰èª²ç¨‹æ¨¡æ…‹æ¡†
        function closeCourseModal() {
            document.getElementById('course-modal').style.display = 'none';
        }
        
        // ==================== ç”¨æˆ¶è³‡æ–™ç®¡ç†åŠŸèƒ½ ====================
        
        // è¼‰å…¥ç®¡ç†å“¡è³‡æ–™
        async function loadAdminProfile() {
            try {
                const response = await fetch('/api/admin/profile');
                const profile = await response.json();
                
                document.getElementById('admin-profile-username').value = profile.username;
                
                const infoContainer = document.getElementById('admin-profile-info');
                infoContainer.innerHTML = `
                    <p><strong>ç”¨æˆ¶åï¼š</strong> ${profile.username}</p>
                    <p><strong>å‰µå»ºæ™‚é–“ï¼š</strong> ${new Date(profile.created_at).toLocaleString('zh-TW')}</p>
                `;
            } catch (error) {
                alert('è¼‰å…¥ç®¡ç†å“¡è³‡æ–™å¤±æ•—');
            }
        }
        
        // æ›´æ–°ç®¡ç†å“¡è³‡æ–™
        async function updateAdminProfile() {
            const username = document.getElementById('admin-profile-username').value.trim();
            const password = document.getElementById('admin-profile-password').value;
            const passwordConfirm = document.getElementById('admin-profile-password-confirm').value;
            
            if (!username) {
                alert('è«‹è¼¸å…¥ç”¨æˆ¶å');
                return;
            }
            
            if (password && password !== passwordConfirm) {
                alert('å…©æ¬¡è¼¸å…¥çš„å¯†ç¢¼ä¸ä¸€è‡´');
                return;
            }
            
            if (password && password.length < 6) {
                alert('å¯†ç¢¼é•·åº¦è‡³å°‘6ä½');
                return;
            }
            
            const profileData = { username };
            if (password) {
                profileData.password = password;
            }
            
            try {
                const response = await fetch('/api/admin/profile', {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(profileData)
                });
                
                if (response.ok) {
                    document.getElementById('admin-profile-password').value = '';
                    document.getElementById('admin-profile-password-confirm').value = '';
                    loadAdminProfile();
                    alert('è³‡æ–™æ›´æ–°æˆåŠŸ');
                } else {
                    const error = await response.json();
                    alert(error.error || 'æ›´æ–°å¤±æ•—ï¼Œè«‹é‡è©¦');
                }
            } catch (error) {
                alert('æ›´æ–°å¤±æ•—ï¼Œè«‹é‡è©¦');
            }
        }

        // é é¢è¼‰å…¥æ™‚åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            showHome();
        });

        // ==================== æ•¸æ“šå°å‡ºåŠŸèƒ½ ====================
        
        // æ¸…é™¤å°å‡ºæ—¥æœŸ
        function clearExportDates() {
            document.getElementById('export-start-date').value = '';
            document.getElementById('export-end-date').value = '';
        }
        
        // è¨­ç½®ä»Šå¤©ç¯„åœ
        function setTodayRange() {
            const today = new Date();
            const startOfDay = new Date(today.getFullYear(), today.getMonth(), today.getDate());
            const endOfDay = new Date(today.getFullYear(), today.getMonth(), today.getDate(), 23, 59, 59);
            
            document.getElementById('export-start-date').value = formatDateTimeLocal(startOfDay);
            document.getElementById('export-end-date').value = formatDateTimeLocal(endOfDay);
        }
        
        // è¨­ç½®æœ¬é€±ç¯„åœ
        function setWeekRange() {
            const today = new Date();
            const dayOfWeek = today.getDay();
            const startOfWeek = new Date(today.getFullYear(), today.getMonth(), today.getDate() - dayOfWeek);
            const endOfWeek = new Date(today.getFullYear(), today.getMonth(), today.getDate() + (6 - dayOfWeek), 23, 59, 59);
            
            document.getElementById('export-start-date').value = formatDateTimeLocal(startOfWeek);
            document.getElementById('export-end-date').value = formatDateTimeLocal(endOfWeek);
        }
        
        // è¨­ç½®æœ¬æœˆç¯„åœ
        function setMonthRange() {
            const today = new Date();
            const startOfMonth = new Date(today.getFullYear(), today.getMonth(), 1);
            const endOfMonth = new Date(today.getFullYear(), today.getMonth() + 1, 0, 23, 59, 59);
            
            document.getElementById('export-start-date').value = formatDateTimeLocal(startOfMonth);
            document.getElementById('export-end-date').value = formatDateTimeLocal(endOfMonth);
        }
        
        // æ ¼å¼åŒ–æ—¥æœŸæ™‚é–“ç‚ºæœ¬åœ°æ ¼å¼
        function formatDateTimeLocal(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const hours = String(date.getHours()).padStart(2, '0');
            const minutes = String(date.getMinutes()).padStart(2, '0');
            
            return `${year}-${month}-${day}T${hours}:${minutes}`;
        }
        
        // æ¸…é™¤ç¯©é¸ç¯„åœå…§çš„æ•¸æ“š
        async function clearFilteredData() {
            const startDate = document.getElementById('export-start-date').value;
            const endDate = document.getElementById('export-end-date').value;
            
            if (!startDate && !endDate) {
                alert('è«‹é¸æ“‡è¦æ¸…é™¤çš„æ—¥æœŸç¯„åœ');
                return;
            }
            
            const dateRange = startDate && endDate ? 
                `${startDate} è‡³ ${endDate}` : 
                startDate ? `${startDate} ä¹‹å¾Œ` : `${endDate} ä¹‹å‰`;
            
            if (!confirm(`ç¢ºå®šè¦æ¸…é™¤ ${dateRange} çš„æ•¸æ“šå—ï¼Ÿæ­¤æ“ä½œç„¡æ³•æ’¤éŠ·ã€‚`)) {
                return;
            }
            
            try {
                const response = await fetch('/api/admin/clear_data', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        start_date: startDate || null,
                        end_date: endDate || null
                    })
                });
                
                const result = await response.json();
                if (result.success) {
                    alert('æ•¸æ“šæ¸…é™¤æˆåŠŸ');
                    loadDetailedStats();
                    loadAdminStats();
                } else {
                    alert('æ•¸æ“šæ¸…é™¤å¤±æ•—');
                }
            } catch (error) {
                console.error('æ¸…é™¤æ•¸æ“šå¤±æ•—:', error);
                alert('æ¸…é™¤æ•¸æ“šå¤±æ•—ï¼Œè«‹é‡è©¦');
            }
        }
        
        // å°å‡ºExcel
        async function exportExcel() {
            const startDate = document.getElementById('export-start-date').value;
            const endDate = document.getElementById('export-end-date').value;
            
            // é¡¯ç¤ºè¼‰å…¥ç‹€æ…‹
            document.getElementById('excel-loading').style.display = 'inline';
            document.getElementById('excel-text').style.display = 'none';
            
            try {
                const response = await fetch('/api/admin/export/excel', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        start_date: startDate || null,
                        end_date: endDate || null
                    })
                });
                
                const result = await response.json();
                if (result.success) {
                    // å‰µå»ºä¸‹è¼‰éˆæ¥
                    const link = document.createElement('a');
                    link.href = 'data:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;base64,' + result.data;
                    link.download = result.filename;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    alert('Excelæ–‡ä»¶å°å‡ºæˆåŠŸï¼');
                } else {
                    alert('Excelå°å‡ºå¤±æ•—ï¼š' + result.error);
                }
            } catch (error) {
                console.error('Excelå°å‡ºå¤±æ•—:', error);
                alert('Excelå°å‡ºå¤±æ•—ï¼Œè«‹é‡è©¦');
            } finally {
                // æ¢å¾©æŒ‰éˆ•ç‹€æ…‹
                document.getElementById('excel-loading').style.display = 'none';
                document.getElementById('excel-text').style.display = 'inline';
            }
        }
        
        // å°å‡ºPowerPoint
        async function exportPowerPoint() {
            const startDate = document.getElementById('export-start-date').value;
            const endDate = document.getElementById('export-end-date').value;
            
            // é¡¯ç¤ºè¼‰å…¥ç‹€æ…‹
            document.getElementById('ppt-loading').style.display = 'inline';
            document.getElementById('ppt-text').style.display = 'none';
            
            try {
                const response = await fetch('/api/admin/export/powerpoint', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        start_date: startDate || null,
                        end_date: endDate || null
                    })
                });
                
                const result = await response.json();
                if (result.success) {
                    // å‰µå»ºä¸‹è¼‰éˆæ¥
                    const link = document.createElement('a');
                    link.href = 'data:application/vnd.openxmlformats-officedocument.presentationml.presentation;base64,' + result.data;
                    link.download = result.filename;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    alert('PowerPointæ–‡ä»¶å°å‡ºæˆåŠŸï¼');
                } else {
                    alert('PowerPointå°å‡ºå¤±æ•—ï¼š' + result.error);
                }
            } catch (error) {
                console.error('PowerPointå°å‡ºå¤±æ•—:', error);
                alert('PowerPointå°å‡ºå¤±æ•—ï¼Œè«‹é‡è©¦');
            } finally {
                // æ¢å¾©æŒ‰éˆ•ç‹€æ…‹
                document.getElementById('ppt-loading').style.display = 'none';
                document.getElementById('ppt-text').style.display = 'inline';
            }
        }
        
        // ==================== è©•åˆ†è¨­å®šåŠŸèƒ½ ====================
        
        // è¼‰å…¥è©•åˆ†è¨­å®š
        async function loadScoreSettings() {
            try {
                const response = await fetch('/api/admin/score-settings', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                if (!response.ok) {
                    throw new Error('è¼‰å…¥è©•åˆ†è¨­å®šå¤±æ•—');
                }
                
                const data = await response.json();
                displayScoreSettings(data.settings);
                
            } catch (error) {
                console.error('è¼‰å…¥è©•åˆ†è¨­å®šéŒ¯èª¤:', error);
                document.getElementById('score-settings-list').innerHTML = 
                    '<p style="text-align: center; color: #dc3545; padding: 40px;">è¼‰å…¥è©•åˆ†è¨­å®šå¤±æ•—ï¼Œè«‹é‡è©¦</p>';
            }
        }
        
        // é¡¯ç¤ºè©•åˆ†è¨­å®šåˆ—è¡¨
        function displayScoreSettings(settings) {
            const container = document.getElementById('score-settings-list');
            
            if (!settings || settings.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 40px;">æš«ç„¡è©•åˆ†è¨­å®š</p>';
                return;
            }
            
            let html = `
                <div style="display: grid; gap: 15px;">
            `;
            
            settings.forEach(setting => {
                const statusClass = setting.is_active ? 'success' : 'secondary';
                const statusText = setting.is_active ? 'å•Ÿç”¨' : 'åœç”¨';
                
                html += `
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; border-left: 5px solid ${setting.is_active ? '#28a745' : '#6c757d'};">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <h5 style="margin: 0; color: #333;">${setting.level_name}</h5>
                            <div style="display: flex; gap: 10px; align-items: center;">
                                <span style="padding: 4px 12px; background: ${setting.is_active ? '#28a745' : '#6c757d'}; color: white; border-radius: 15px; font-size: 12px;">
                                    ${statusText}
                                </span>
                                <button onclick="editScoreSetting(${setting.id})" style="padding: 5px 10px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 12px;">
                                    ç·¨è¼¯
                                </button>
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <strong>åˆ†æ•¸ç¯„åœï¼š</strong>${setting.min_score} - ${setting.max_score} åˆ†
                            </div>
                            <div style="color: #666; font-size: 14px;">
                                æ’åºï¼šç¬¬ ${setting.order} ä½
                            </div>
                        </div>
                        ${setting.description ? `<div style="margin-top: 10px; color: #666; font-size: 14px;">${setting.description}</div>` : ''}
                    </div>
                `;
            });
            
            html += '</div>';
            container.innerHTML = html;
        }
        
        // ç·¨è¼¯è©•åˆ†è¨­å®š
        async function editScoreSetting(settingId) {
            try {
                // è¼‰å…¥è©•åˆ†è¨­å®šæ•¸æ“š
                const response = await fetch('/api/admin/score-settings', {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                if (!response.ok) {
                    throw new Error('è¼‰å…¥è©•åˆ†è¨­å®šå¤±æ•—');
                }
                
                const data = await response.json();
                const setting = data.settings.find(s => s.id === settingId);
                
                if (!setting) {
                    alert('æ‰¾ä¸åˆ°æŒ‡å®šçš„è©•åˆ†è¨­å®š');
                    return;
                }
                
                // å¡«å……æ¨¡æ…‹æ¡†æ•¸æ“š
                document.getElementById('score-setting-modal-title').textContent = 'ç·¨è¼¯è©•åˆ†è¨­å®š';
                document.getElementById('score-setting-level-name').value = setting.level_name;
                document.getElementById('score-setting-min-score').value = setting.min_score;
                document.getElementById('score-setting-max-score').value = setting.max_score;
                document.getElementById('score-setting-description').value = setting.description || '';
                document.getElementById('score-setting-active').checked = setting.is_active;
                
                // è¨­ç½®ç·¨è¼¯ç‹€æ…‹
                window.currentEditingScoreSetting = settingId;
                
                // é¡¯ç¤ºæ¨¡æ…‹æ¡†
                document.getElementById('score-setting-modal').style.display = 'block';
                
            } catch (error) {
                console.error('è¼‰å…¥è©•åˆ†è¨­å®šå¤±æ•—:', error);
                alert('è¼‰å…¥è©•åˆ†è¨­å®šå¤±æ•—ï¼Œè«‹é‡è©¦');
            }
        }
        
        // åˆ·æ–°è©•åˆ†è¨­å®š
        function refreshScoreSettings() {
            loadScoreSettings();
        }
        
        // ä¿å­˜è©•åˆ†è¨­å®š
        async function saveScoreSetting() {
            try {
                const levelName = document.getElementById('score-setting-level-name').value.trim();
                const minScore = parseInt(document.getElementById('score-setting-min-score').value);
                const maxScore = parseInt(document.getElementById('score-setting-max-score').value);
                const description = document.getElementById('score-setting-description').value.trim();
                const isActive = document.getElementById('score-setting-active').checked;
                
                // é©—è­‰è¼¸å…¥
                if (!levelName) {
                    alert('è«‹è¼¸å…¥ç­‰ç´šåç¨±');
                    return;
                }
                
                if (isNaN(minScore) || isNaN(maxScore)) {
                    alert('è«‹è¼¸å…¥æœ‰æ•ˆçš„åˆ†æ•¸ç¯„åœ');
                    return;
                }
                
                if (minScore >= maxScore) {
                    alert('æœ€ä½åˆ†æ•¸å¿…é ˆå°æ–¼æœ€é«˜åˆ†æ•¸');
                    return;
                }
                
                if (minScore < 0 || maxScore > 100) {
                    alert('åˆ†æ•¸ç¯„åœå¿…é ˆåœ¨0-100ä¹‹é–“');
                    return;
                }
                
                const settingData = {
                    level_name: levelName,
                    min_score: minScore,
                    max_score: maxScore,
                    description: description,
                    is_active: isActive
                };
                
                const settingId = window.currentEditingScoreSetting;
                const url = `/api/admin/score-settings/${settingId}`;
                
                const response = await fetch(url, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(settingData)
                });
                
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || 'ä¿å­˜è©•åˆ†è¨­å®šå¤±æ•—');
                }
                
                alert('è©•åˆ†è¨­å®šä¿å­˜æˆåŠŸï¼');
                closeScoreSettingModal();
                loadScoreSettings(); // é‡æ–°è¼‰å…¥åˆ—è¡¨
                
            } catch (error) {
                console.error('ä¿å­˜è©•åˆ†è¨­å®šå¤±æ•—:', error);
                alert('ä¿å­˜è©•åˆ†è¨­å®šå¤±æ•—ï¼š' + error.message);
            }
        }
        
        // é—œé–‰è©•åˆ†è¨­å®šæ¨¡æ…‹æ¡†
        function closeScoreSettingModal() {
            document.getElementById('score-setting-modal').style.display = 'none';
            window.currentEditingScoreSetting = null;
        }
        
        // ==================== æ¨ä»‹èª²ç¨‹æ•¸é‡è¨­å®šåŠŸèƒ½ ====================
        
        // é¡¯ç¤ºæ¨ä»‹èª²ç¨‹æ•¸é‡è¨­å®šç•Œé¢
        function showRecommendationSettings() {
            // éš±è—å…¶ä»–ç•Œé¢
            document.getElementById('courses-list-view').style.display = 'none';
            document.getElementById('edit-course-selection').style.display = 'none';
            document.getElementById('delete-course-selection').style.display = 'none';
            
            // é¡¯ç¤ºæ¨ä»‹è¨­å®šç•Œé¢
            document.getElementById('recommendation-settings').style.display = 'block';
            
            // è¼‰å…¥æ¨ä»‹è¨­å®šæ•¸æ“š
            loadRecommendationSettings();
        }
        
        // è¼‰å…¥æ¨ä»‹èª²ç¨‹æ•¸é‡è¨­å®š
        async function loadRecommendationSettings() {
            try {
                const response = await fetch('/api/admin/recommendation-settings');
                const settings = await response.json();
                
                // é¡¯ç¤ºç•¶å‰å•Ÿç”¨è¨­å®š
                const activeSettings = settings.filter(s => s.is_active);
                const currentSettingDiv = document.getElementById('current-recommendation-setting');
                
                if (activeSettings.length > 0) {
                    const activeSetting = activeSettings[0];
                    currentSettingDiv.innerHTML = `
                        <h5 style="margin: 0 0 10px 0; color: #155724;">âœ… ç•¶å‰å•Ÿç”¨è¨­å®š</h5>
                        <p style="margin: 0; font-size: 16px;"><strong>${activeSetting.setting_name}</strong></p>
                        <p style="margin: 5px 0 0 0; color: #666;">æ¨è–¦èª²ç¨‹æ•¸é‡ï¼š${activeSetting.min_courses} - ${activeSetting.max_courses} å€‹</p>
                        ${activeSetting.description ? `<p style="margin: 5px 0 0 0; color: #666; font-size: 14px;">${activeSetting.description}</p>` : ''}
                    `;
                } else {
                    currentSettingDiv.innerHTML = `
                        <h5 style="margin: 0 0 10px 0; color: #721c24;">âš ï¸ æ²’æœ‰å•Ÿç”¨çš„è¨­å®š</h5>
                        <p style="margin: 0; color: #666;">è«‹é¸æ“‡ä¸€å€‹è¨­å®šä¸¦å•Ÿç”¨</p>
                    `;
                }
                
                // é¡¯ç¤ºæ‰€æœ‰è¨­å®šåˆ—è¡¨
                const settingsListDiv = document.getElementById('recommendation-settings-list');
                if (settings.length === 0) {
                    settingsListDiv.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: #666;">
                            <p>å°šæœªå‰µå»ºä»»ä½•æ¨è–¦è¨­å®š</p>
                            <p>é»æ“Šã€Œæ–°å¢è¨­å®šã€æŒ‰éˆ•é–‹å§‹å‰µå»º</p>
                        </div>
                    `;
                } else {
                    settingsListDiv.innerHTML = `
                        <h5 style="margin-bottom: 15px; color: #333;">æ‰€æœ‰æ¨è–¦è¨­å®š</h5>
                        <div style="display: grid; gap: 15px;">
                            ${settings.map(setting => `
                                <div style="border: 1px solid ${setting.is_active ? '#c3e6cb' : '#dee2e6'}; border-radius: 8px; padding: 15px; background: ${setting.is_active ? '#f8fff9' : '#f8f9fa'};">
                                    <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px;">
                                        <div>
                                            <h6 style="margin: 0; color: #333;">${setting.setting_name} ${setting.is_active ? '<span style="color: #28a745; font-size: 12px;">â—</span>' : ''}</h6>
                                            <p style="margin: 5px 0; color: #666; font-size: 14px;">æ¨è–¦ ${setting.min_courses} - ${setting.max_courses} å€‹èª²ç¨‹</p>
                                            ${setting.description ? `<p style="margin: 5px 0 0 0; color: #666; font-size: 13px;">${setting.description}</p>` : ''}
                                        </div>
                                        <div style="display: flex; gap: 8px; flex-shrink: 0;">
                                            ${!setting.is_active ? `<button onclick="activateRecommendationSetting(${setting.id})" style="padding: 4px 8px; background: #28a745; color: white; border: none; border-radius: 4px; font-size: 12px;">å•Ÿç”¨</button>` : ''}
                                            <button onclick="editRecommendationSetting(${setting.id})" style="padding: 4px 8px; background: #007bff; color: white; border: none; border-radius: 4px; font-size: 12px;">ç·¨è¼¯</button>
                                            ${setting.setting_name !== 'default' ? `<button onclick="deleteRecommendationSetting(${setting.id})" style="padding: 4px 8px; background: #dc3545; color: white; border: none; border-radius: 4px; font-size: 12px;">åˆªé™¤</button>` : ''}
                                        </div>
                                    </div>
                                    <div style="font-size: 12px; color: #999;">
                                        å‰µå»ºæ™‚é–“ï¼š${new Date(setting.created_at).toLocaleString('zh-TW')}
                                        ${setting.updated_at !== setting.created_at ? ` | æ›´æ–°æ™‚é–“ï¼š${new Date(setting.updated_at).toLocaleString('zh-TW')}` : ''}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                }
                
            } catch (error) {
                console.error('è¼‰å…¥æ¨è–¦è¨­å®šå¤±æ•—:', error);
                alert('è¼‰å…¥æ¨è–¦è¨­å®šå¤±æ•—ï¼Œè«‹é‡è©¦');
            }
        }
        
        // é¡¯ç¤ºæ–°å¢æ¨è–¦è¨­å®šæ¨¡æ…‹æ¡†
        function showAddRecommendationSettingModal() {
            document.getElementById('recommendation-setting-modal-title').textContent = 'æ–°å¢æ¨ä»‹èª²ç¨‹æ•¸é‡è¨­å®š';
            document.getElementById('recommendation-setting-name').value = '';
            document.getElementById('recommendation-min-courses').value = '3';
            document.getElementById('recommendation-max-courses').value = '8';
            document.getElementById('recommendation-setting-description').value = '';
            document.getElementById('recommendation-setting-active').checked = false;
            
            // æ¸…é™¤ç·¨è¼¯ç‹€æ…‹
            window.currentEditingRecommendationSetting = null;
            
            document.getElementById('recommendation-setting-modal').style.display = 'block';
        }
        
        // ç·¨è¼¯æ¨è–¦è¨­å®š
        async function editRecommendationSetting(settingId) {
            try {
                const response = await fetch('/api/admin/recommendation-settings');
                const settings = await response.json();
                const setting = settings.find(s => s.id === settingId);
                
                if (!setting) {
                    alert('æ‰¾ä¸åˆ°æŒ‡å®šçš„è¨­å®š');
                    return;
                }
                
                document.getElementById('recommendation-setting-modal-title').textContent = 'ç·¨è¼¯æ¨ä»‹èª²ç¨‹æ•¸é‡è¨­å®š';
                document.getElementById('recommendation-setting-name').value = setting.setting_name;
                document.getElementById('recommendation-min-courses').value = setting.min_courses;
                document.getElementById('recommendation-max-courses').value = setting.max_courses;
                document.getElementById('recommendation-setting-description').value = setting.description || '';
                document.getElementById('recommendation-setting-active').checked = setting.is_active;
                
                // è¨­ç½®ç·¨è¼¯ç‹€æ…‹
                window.currentEditingRecommendationSetting = settingId;
                
                document.getElementById('recommendation-setting-modal').style.display = 'block';
                
            } catch (error) {
                console.error('è¼‰å…¥è¨­å®šå¤±æ•—:', error);
                alert('è¼‰å…¥è¨­å®šå¤±æ•—ï¼Œè«‹é‡è©¦');
            }
        }
        
        // ä¿å­˜æ¨è–¦è¨­å®š
        async function saveRecommendationSetting() {
            try {
                const name = document.getElementById('recommendation-setting-name').value.trim();
                const minCourses = parseInt(document.getElementById('recommendation-min-courses').value);
                const maxCourses = parseInt(document.getElementById('recommendation-max-courses').value);
                const description = document.getElementById('recommendation-setting-description').value.trim();
                const isActive = document.getElementById('recommendation-setting-active').checked;
                
                // é©—è­‰è¼¸å…¥
                if (!name) {
                    alert('è«‹è¼¸å…¥è¨­å®šåç¨±');
                    return;
                }
                
                if (isNaN(minCourses) || isNaN(maxCourses)) {
                    alert('è«‹è¼¸å…¥æœ‰æ•ˆçš„èª²ç¨‹æ•¸é‡');
                    return;
                }
                
                if (minCourses < 0 || maxCourses > 100) {
                    alert('èª²ç¨‹æ•¸é‡å¿…é ˆåœ¨0-100ç¯„åœå…§');
                    return;
                }
                
                if (minCourses > maxCourses) {
                    alert('æœ€å°‘èª²ç¨‹æ•¸é‡ä¸èƒ½å¤§æ–¼æœ€å¤šèª²ç¨‹æ•¸é‡');
                    return;
                }
                
                const data = {
                    setting_name: name,
                    min_courses: minCourses,
                    max_courses: maxCourses,
                    description: description,
                    is_active: isActive
                };
                
                let response;
                if (window.currentEditingRecommendationSetting) {
                    // æ›´æ–°ç¾æœ‰è¨­å®š
                    response = await fetch(`/api/admin/recommendation-settings/${window.currentEditingRecommendationSetting}`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(data)
                    });
                } else {
                    // å‰µå»ºæ–°è¨­å®š
                    response = await fetch('/api/admin/recommendation-settings', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(data)
                    });
                }
                
                const result = await response.json();
                
                if (response.ok) {
                    alert(result.message);
                    closeRecommendationSettingModal();
                    loadRecommendationSettings();
                } else {
                    alert(result.error || 'ä¿å­˜å¤±æ•—');
                }
                
            } catch (error) {
                console.error('ä¿å­˜è¨­å®šå¤±æ•—:', error);
                alert('ä¿å­˜è¨­å®šå¤±æ•—ï¼Œè«‹é‡è©¦');
            }
        }
        
        // å•Ÿç”¨æ¨è–¦è¨­å®š
        async function activateRecommendationSetting(settingId) {
            try {
                const response = await fetch(`/api/admin/recommendation-settings/${settingId}/activate`, {
                    method: 'POST'
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    alert(result.message);
                    loadRecommendationSettings();
                } else {
                    alert(result.error || 'å•Ÿç”¨å¤±æ•—');
                }
                
            } catch (error) {
                console.error('å•Ÿç”¨è¨­å®šå¤±æ•—:', error);
                alert('å•Ÿç”¨è¨­å®šå¤±æ•—ï¼Œè«‹é‡è©¦');
            }
        }
        
        // åˆªé™¤æ¨è–¦è¨­å®š
        async function deleteRecommendationSetting(settingId) {
            if (!confirm('ç¢ºå®šè¦åˆªé™¤é€™å€‹æ¨è–¦è¨­å®šå—ï¼Ÿæ­¤æ“ä½œç„¡æ³•æ’¤éŠ·ã€‚')) {
                return;
            }
            
            try {
                const response = await fetch(`/api/admin/recommendation-settings/${settingId}`, {
                    method: 'DELETE'
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    alert(result.message);
                    loadRecommendationSettings();
                } else {
                    alert(result.error || 'åˆªé™¤å¤±æ•—');
                }
                
            } catch (error) {
                console.error('åˆªé™¤è¨­å®šå¤±æ•—:', error);
                alert('åˆªé™¤è¨­å®šå¤±æ•—ï¼Œè«‹é‡è©¦');
            }
        }
        
        // é—œé–‰æ¨è–¦è¨­å®šæ¨¡æ…‹æ¡†
        function closeRecommendationSettingModal() {
            document.getElementById('recommendation-setting-modal').style.display = 'none';
            window.currentEditingRecommendationSetting = null;
        }
        
        // é é¢è¼‰å…¥å®Œæˆå¾Œçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ–é é¢
            console.log('é é¢è¼‰å…¥å®Œæˆ');
        });
        
    </script>
</body>
</html>
